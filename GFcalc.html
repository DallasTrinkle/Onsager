

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GFcalc &mdash; Onsager 1.4 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=0ed52906"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="OnsagerCalc" href="OnsagerCalc.html" />
    <link rel="prev" title="PowerExpansion" href="PowerExpansion.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Onsager
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="includeme.html">Onsager</a></li>
<li class="toctree-l1"><a class="reference internal" href="InputOutput.html">Input and output for Onsager transport calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks.html">Example Notebooks</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="crystal.html">Crystal</a></li>
<li class="toctree-l2"><a class="reference internal" href="CrystalStars.html">CrystalStars</a></li>
<li class="toctree-l2"><a class="reference internal" href="supercell.html">Supercell</a></li>
<li class="toctree-l2"><a class="reference internal" href="cluster.html">Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="PowerExpansion.html">PowerExpansion</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">GFcalc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#GFcalc.GFCrystalcalc"><code class="docutils literal notranslate"><span class="pre">GFCrystalcalc</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#GFcalc.GFCrystalcalc.BlockInvertOmegaTaylor"><code class="docutils literal notranslate"><span class="pre">GFCrystalcalc.BlockInvertOmegaTaylor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#GFcalc.GFCrystalcalc.BlockRotateOmegaTaylor"><code class="docutils literal notranslate"><span class="pre">GFCrystalcalc.BlockRotateOmegaTaylor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#GFcalc.GFCrystalcalc.BreakdownGroups"><code class="docutils literal notranslate"><span class="pre">GFCrystalcalc.BreakdownGroups()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#GFcalc.GFCrystalcalc.DiagGamma"><code class="docutils literal notranslate"><span class="pre">GFCrystalcalc.DiagGamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#GFcalc.GFCrystalcalc.Diffusivity"><code class="docutils literal notranslate"><span class="pre">GFCrystalcalc.Diffusivity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#GFcalc.GFCrystalcalc.FourierTransformJumps"><code class="docutils literal notranslate"><span class="pre">GFCrystalcalc.FourierTransformJumps()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#GFcalc.GFCrystalcalc.SetRates"><code class="docutils literal notranslate"><span class="pre">GFCrystalcalc.SetRates()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#GFcalc.GFCrystalcalc.SymmRates"><code class="docutils literal notranslate"><span class="pre">GFCrystalcalc.SymmRates()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#GFcalc.GFCrystalcalc.TaylorExpandJumps"><code class="docutils literal notranslate"><span class="pre">GFCrystalcalc.TaylorExpandJumps()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#GFcalc.GFCrystalcalc.__call__"><code class="docutils literal notranslate"><span class="pre">GFCrystalcalc.__call__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#GFcalc.GFCrystalcalc.__init__"><code class="docutils literal notranslate"><span class="pre">GFCrystalcalc.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#GFcalc.GFCrystalcalc.__str__"><code class="docutils literal notranslate"><span class="pre">GFCrystalcalc.__str__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#GFcalc.GFCrystalcalc.__weakref__"><code class="docutils literal notranslate"><span class="pre">GFCrystalcalc.__weakref__</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#GFcalc.GFCrystalcalc.addhdf5"><code class="docutils literal notranslate"><span class="pre">GFCrystalcalc.addhdf5()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#GFcalc.GFCrystalcalc.biascorrection"><code class="docutils literal notranslate"><span class="pre">GFCrystalcalc.biascorrection()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#GFcalc.GFCrystalcalc.exp_dxq"><code class="docutils literal notranslate"><span class="pre">GFCrystalcalc.exp_dxq()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#GFcalc.GFCrystalcalc.loadhdf5"><code class="docutils literal notranslate"><span class="pre">GFCrystalcalc.loadhdf5()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#GFcalc.GFCrystalcalc.networkcount"><code class="docutils literal notranslate"><span class="pre">GFCrystalcalc.networkcount()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="OnsagerCalc.html">OnsagerCalc</a></li>
<li class="toctree-l2"><a class="reference internal" href="automator.html">Automator</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Onsager</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">Modules</a></li>
      <li class="breadcrumb-item active">GFcalc</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/GFcalc.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="gfcalc">
<h1>GFcalc<a class="headerlink" href="#gfcalc" title="Link to this heading"></a></h1>
<p>GFcalc:</p>
<p>The GFcalc module defines the <code class="docutils literal notranslate"><span class="pre">GFCrystalcalc</span></code> class for the evaluation of the vacancy Green function.</p>
<p id="module-GFcalc">GFcalc module</p>
<p>Code to compute the lattice Green function for diffusion; this entails inverting
the “diffusion” matrix, which is infinite, singular, and has translational
invariance. The solution involves fourier transforming to reciprocal space,
inverting, and inverse fourier transforming back to real (lattice) space. The
complication is that the inversion produces a second order pole which must be
treated analytically. Subtracting off the pole then produces a discontinuity at
the gamma-point (q=0), which also should be treated analytically. Then, the
remaining function can be numerically inverse fourier transformed.</p>
<dl class="py class">
<dt class="sig sig-object py" id="GFcalc.GFCrystalcalc">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">GFcalc.</span></span><span class="sig-name descname"><span class="pre">GFCrystalcalc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sitelist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jumpnetwork</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kptwt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/GFcalc.html#GFCrystalcalc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GFcalc.GFCrystalcalc" title="Link to this definition"></a></dt>
<dd><p>Class calculator for the Green function, designed to work with the Crystal class.</p>
<p>This computes the bare vacancy GF. It requires a crystal, chemical identity for the
vacancy, list of symmetry unique sites (to define energies / entropies uniquely), and
a corresponding jumpnetwork for that vacancy.</p>
<dl class="py method">
<dt class="sig sig-object py" id="GFcalc.GFCrystalcalc.BlockInvertOmegaTaylor">
<span class="sig-name descname"><span class="pre">BlockInvertOmegaTaylor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/GFcalc.html#GFCrystalcalc.BlockInvertOmegaTaylor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GFcalc.GFCrystalcalc.BlockInvertOmegaTaylor" title="Link to this definition"></a></dt>
<dd><p>Returns block inverted omega as a Taylor expansion, up to Nmax = 0 (discontinuity
correction). Needs to be rotated such that leading order of D is isotropic.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dd</strong> – diffusive/diffusive block (upper left)</p></li>
<li><p><strong>dr</strong> – diffusive/relaxive block (lower left)</p></li>
<li><p><strong>rd</strong> – relaxive/diffusive block (upper right)</p></li>
<li><p><strong>rr</strong> – relaxive/relaxive block (lower right)</p></li>
<li><p><strong>D</strong> – <span class="math notranslate nohighlight">\(dd - dr (rr)^{-1} rd\)</span> (diffusion)</p></li>
</ul>
</dd>
<dt class="field-even">Return gT<span class="colon">:</span></dt>
<dd class="field-even"><p>Taylor expansion of g in block form, and reduced (collected terms)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="GFcalc.GFCrystalcalc.BlockRotateOmegaTaylor">
<span class="sig-name descname"><span class="pre">BlockRotateOmegaTaylor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">omega_Taylor_rotate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/GFcalc.html#GFCrystalcalc.BlockRotateOmegaTaylor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GFcalc.GFCrystalcalc.BlockRotateOmegaTaylor" title="Link to this definition"></a></dt>
<dd><p>Returns block partitioned Taylor expansion of a rotated omega Taylor expansion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>omega_Taylor_rotate</strong> – rotated into diffusive [0] / relaxive [1:] basis</p>
</dd>
<dt class="field-even">Return dd<span class="colon">:</span></dt>
<dd class="field-even"><p>diffusive/diffusive block (upper left)</p>
</dd>
<dt class="field-odd">Return dr<span class="colon">:</span></dt>
<dd class="field-odd"><p>diffusive/relaxive block (lower left)</p>
</dd>
<dt class="field-even">Return rd<span class="colon">:</span></dt>
<dd class="field-even"><p>relaxive/diffusive block (upper right)</p>
</dd>
<dt class="field-odd">Return rr<span class="colon">:</span></dt>
<dd class="field-odd"><p>relaxive/relaxive block (lower right)</p>
</dd>
<dt class="field-even">Return D<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="math notranslate nohighlight">\(dd - dr (rr)^{-1} rd\)</span> (diffusion)</p>
</dd>
<dt class="field-odd">Return etav<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="math notranslate nohighlight">\((rr)^{-1} rd\)</span> (relaxation vector)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="GFcalc.GFCrystalcalc.BreakdownGroups">
<span class="sig-name descname"><span class="pre">BreakdownGroups</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/GFcalc.html#GFCrystalcalc.BreakdownGroups"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GFcalc.GFCrystalcalc.BreakdownGroups" title="Link to this definition"></a></dt>
<dd><p>Takes in a crystal, and a chemistry, and constructs the indexing breakdown for each
(i,j) pair.
:return grouparray: array[NG][3][3] of the NG group operations
:return indexpair: array[N][N][NG][2] of the index pair for each group operation</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="GFcalc.GFCrystalcalc.DiagGamma">
<span class="sig-name descname"><span class="pre">DiagGamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/GFcalc.html#GFCrystalcalc.DiagGamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GFcalc.GFCrystalcalc.DiagGamma" title="Link to this definition"></a></dt>
<dd><p>Diagonalize the gamma point (q=0) term</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>omega</strong> – optional; the Taylor expansion to use. If None, use self.omega_Taylor</p>
</dd>
<dt class="field-even">Return r<span class="colon">:</span></dt>
<dd class="field-even"><p>array of eigenvalues, sorted from 0 to decreasing values.</p>
</dd>
<dt class="field-odd">Return vr<span class="colon">:</span></dt>
<dd class="field-odd"><p>array of eigenvectors where vr[:,i] is the vector for eigenvalue r[i]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="GFcalc.GFCrystalcalc.Diffusivity">
<span class="sig-name descname"><span class="pre">Diffusivity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">omega_Taylor_D</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/GFcalc.html#GFCrystalcalc.Diffusivity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GFcalc.GFCrystalcalc.Diffusivity" title="Link to this definition"></a></dt>
<dd><p>Return the diffusivity, or compute it if it’s not already known. Uses omega_Taylor_D
to compute with maximum efficiency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>omega_Taylor_D</strong> – Taylor expansion of the diffusivity component</p>
</dd>
<dt class="field-even">Return D<span class="colon">:</span></dt>
<dd class="field-even"><p>diffusivity [3,3] array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="GFcalc.GFCrystalcalc.FourierTransformJumps">
<span class="sig-name descname"><span class="pre">FourierTransformJumps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jumpnetwork</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/GFcalc.html#GFCrystalcalc.FourierTransformJumps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GFcalc.GFCrystalcalc.FourierTransformJumps" title="Link to this definition"></a></dt>
<dd><p>Generate the Fourier transform coefficients for each jump</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jumpnetwork</strong> – list of unique transitions, as lists of ((i,j), dx)</p></li>
<li><p><strong>N</strong> – number of sites</p></li>
<li><p><strong>kpts</strong> – array[Nkpt][3], in Cartesian (same coord. as dx)</p></li>
</ul>
</dd>
<dt class="field-even">Return FTjumps<span class="colon">:</span></dt>
<dd class="field-even"><p>array[Njump][Nkpt][Nsite][Nsite] of FT of the jump network</p>
</dd>
<dt class="field-odd">Return SEjumps<span class="colon">:</span></dt>
<dd class="field-odd"><p>array[Nsite][Njump] multiplicity of jump on each site</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="GFcalc.GFCrystalcalc.SetRates">
<span class="sig-name descname"><span class="pre">SetRates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pre</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">betaene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">betaeneT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pmaxerror</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/GFcalc.html#GFCrystalcalc.SetRates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GFcalc.GFCrystalcalc.SetRates" title="Link to this definition"></a></dt>
<dd><p>(Re)sets the rates, given the prefactors and Arrhenius factors for the sites and
transitions, using the ordering according to sitelist and jumpnetwork. Initiates all of
the calculations so that GF calculation is (fairly) efficient for each input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pre</strong> – list of prefactors for site probabilities</p></li>
<li><p><strong>betaene</strong> – list of beta*E (energy/kB T) for each site</p></li>
<li><p><strong>preT</strong> – list of prefactors for transition states</p></li>
<li><p><strong>betaeneT</strong> – list of beta*ET (energy/kB T) for each transition state</p></li>
<li><p><strong>pmaxerror</strong> – parameter controlling error from pmax value. Should be same order as integration error.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="GFcalc.GFCrystalcalc.SymmRates">
<span class="sig-name descname"><span class="pre">SymmRates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pre</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">betaene</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">betaeneT</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/GFcalc.html#GFCrystalcalc.SymmRates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GFcalc.GFCrystalcalc.SymmRates" title="Link to this definition"></a></dt>
<dd><p>Returns a list of lists of symmetrized rates, matched to jumpnetwork</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="GFcalc.GFCrystalcalc.TaylorExpandJumps">
<span class="sig-name descname"><span class="pre">TaylorExpandJumps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jumpnetwork</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/GFcalc.html#GFCrystalcalc.TaylorExpandJumps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GFcalc.GFCrystalcalc.TaylorExpandJumps" title="Link to this definition"></a></dt>
<dd><p>Generate the Taylor expansion coefficients for each jump</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jumpnetwork</strong> – list of unique transitions, as lists of ((i,j), dx)</p></li>
<li><p><strong>N</strong> – number of sites</p></li>
</ul>
</dd>
<dt class="field-even">Return T3Djumps<span class="colon">:</span></dt>
<dd class="field-even"><p>list of Taylor3D expansions of the jump network</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="GFcalc.GFCrystalcalc.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/GFcalc.html#GFCrystalcalc.__call__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GFcalc.GFCrystalcalc.__call__" title="Link to this definition"></a></dt>
<dd><p>Evaluate the Green function from site i to site j, separated by vector dx</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – site index</p></li>
<li><p><strong>j</strong> – site index</p></li>
<li><p><strong>dx</strong> – vector pointing from i to j (can include lattice contributions)</p></li>
</ul>
</dd>
<dt class="field-even">Return G<span class="colon">:</span></dt>
<dd class="field-even"><p>Green function value</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="GFcalc.GFCrystalcalc.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sitelist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jumpnetwork</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kptwt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/GFcalc.html#GFCrystalcalc.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GFcalc.GFCrystalcalc.__init__" title="Link to this definition"></a></dt>
<dd><p>Initializes our calculator with the appropriate topology / connectivity. Doesn’t
require, at this point, the site probabilities or transition rates to be known.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crys</strong> – Crystal object</p></li>
<li><p><strong>chem</strong> – index identifying the diffusing species</p></li>
<li><p><strong>sitelist</strong> – list, grouped into Wyckoff common positions, of unique sites</p></li>
<li><p><strong>jumpnetwork</strong> – list of unique transitions as lists of ((i,j), dx)</p></li>
<li><p><strong>Nmax</strong> – maximum range as estimator for kpt mesh generation</p></li>
<li><p><strong>kptwt</strong> – (optional) tuple of (kpts, wts) to short-circuit kpt mesh generation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="GFcalc.GFCrystalcalc.__str__">
<span class="sig-name descname"><span class="pre">__str__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/GFcalc.html#GFCrystalcalc.__str__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GFcalc.GFCrystalcalc.__str__" title="Link to this definition"></a></dt>
<dd><p>Return str(self).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="GFcalc.GFCrystalcalc.__weakref__">
<span class="sig-name descname"><span class="pre">__weakref__</span></span><a class="headerlink" href="#GFcalc.GFCrystalcalc.__weakref__" title="Link to this definition"></a></dt>
<dd><p>list of weak references to the object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="GFcalc.GFCrystalcalc.addhdf5">
<span class="sig-name descname"><span class="pre">addhdf5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">HDF5group</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/GFcalc.html#GFCrystalcalc.addhdf5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GFcalc.GFCrystalcalc.addhdf5" title="Link to this definition"></a></dt>
<dd><p>Adds an HDF5 representation of object into an HDF5group (needs to already exist).</p>
<p>Example: if f is an open HDF5, then GFcalc.addhdf5(f.create_group(‘GFcalc’)) will
(1) create the group named ‘GFcalc’, and then (2) put the GFcalc representation in that group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>HDF5group</strong> – HDF5 group</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="GFcalc.GFCrystalcalc.biascorrection">
<span class="sig-name descname"><span class="pre">biascorrection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">etav</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/GFcalc.html#GFCrystalcalc.biascorrection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GFcalc.GFCrystalcalc.biascorrection" title="Link to this definition"></a></dt>
<dd><p>Return the bias correction, or compute it if it’s not already known. Uses etav to compute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>etav</strong> – Taylor expansion of the bias correction</p>
</dd>
<dt class="field-even">Return eta<span class="colon">:</span></dt>
<dd class="field-even"><p>[N,3] array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="GFcalc.GFCrystalcalc.exp_dxq">
<span class="sig-name descname"><span class="pre">exp_dxq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/GFcalc.html#GFCrystalcalc.exp_dxq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GFcalc.GFCrystalcalc.exp_dxq" title="Link to this definition"></a></dt>
<dd><p>Return the array of exp(-i q.dx) evaluated over the q-points, and accounting for symmetry</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dx</strong> – vector</p>
</dd>
<dt class="field-even">Return exp(-i q.dx)<span class="colon">:</span></dt>
<dd class="field-even"><p>array of <span class="math notranslate nohighlight">\(\exp(-i \cdot dx)\)</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="GFcalc.GFCrystalcalc.loadhdf5">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">loadhdf5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">HDF5group</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/GFcalc.html#GFCrystalcalc.loadhdf5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GFcalc.GFCrystalcalc.loadhdf5" title="Link to this definition"></a></dt>
<dd><p>Creates a new GFcalc from an HDF5 group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crys</strong> – crystal object–MUST BE PASSED IN as it is not stored with the GFcalc</p></li>
<li><p><strong>HDFgroup</strong> – HDF5 group</p></li>
</ul>
</dd>
<dt class="field-even">Return GFcalc<span class="colon">:</span></dt>
<dd class="field-even"><p>new GFcalc object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="GFcalc.GFCrystalcalc.networkcount">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">networkcount</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jumpnetwork</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/GFcalc.html#GFCrystalcalc.networkcount"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#GFcalc.GFCrystalcalc.networkcount" title="Link to this definition"></a></dt>
<dd><p>Return a count of how many separate connected networks there are</p>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="PowerExpansion.html" class="btn btn-neutral float-left" title="PowerExpansion" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="OnsagerCalc.html" class="btn btn-neutral float-right" title="OnsagerCalc" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017, Dallas R. Trinkle.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>