

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Large \(\omega^2\) correction &mdash; Onsager 1.4 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=0ed52906"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Si in FCC Ni" href="NiSi.html" />
    <link rel="prev" title="Garnet correlation coefficients" href="Garnet.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Onsager
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../includeme.html">Onsager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../InputOutput.html">Input and output for Onsager transport calculation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../notebooks.html">Example Notebooks</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Fe-C.html">Fe-C diffusion and elastodiffusivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="GF-convergence.html">Convergence of Green function calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tracer-correlation.html">Tracer correlation coefficients</a></li>
<li class="toctree-l2"><a class="reference internal" href="Garnet.html">Garnet correlation coefficients</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Large <span class="math notranslate nohighlight">\(\omega^2\)</span> correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="NiSi.html">Si in FCC Ni</a></li>
<li class="toctree-l2"><a class="reference internal" href="FCC-Co-O.html">Split oxygen-vacancy defects in Co</a></li>
<li class="toctree-l2"><a class="reference internal" href="Random-alloy.html">Binary random alloy with dilute vacancy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Modules</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Onsager</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../notebooks.html">Example Notebooks</a></li>
      <li class="breadcrumb-item active">Large <span class="math notranslate nohighlight">\(\omega^2\)</span> correction</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/examples/LargeOmega2.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Large-\omega^2-correction">
<h1>Large <span class="math notranslate nohighlight">\(\omega^2\)</span> correction<a class="headerlink" href="#Large-\omega^2-correction" title="Link to this heading">ÔÉÅ</a></h1>
<p>In the limit of large <span class="math notranslate nohighlight">\(\omega^2\)</span>, large roundoff error can become problematic as the correlation almost exactly matches the uncorrelated contribution to solute diffusion, and so it becomes necessary to introduce an alternative treatment specific to the large <span class="math notranslate nohighlight">\(\omega^2\)</span> limit. We will show the range of roundoff error by using FCC as an example.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;../&#39;</span><span class="p">])</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-whitegrid&#39;</span><span class="p">)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">onsager</span> <span class="kn">import</span> <span class="n">crystal</span><span class="p">,</span> <span class="n">OnsagerCalc</span>
</pre></div>
</div>
</div>
<p>Create FCC crystal, and diffuser with first neighbor range.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a0</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">FCC</span> <span class="o">=</span> <span class="n">crystal</span><span class="o">.</span><span class="n">Crystal</span><span class="o">.</span><span class="n">FCC</span><span class="p">(</span><span class="n">a0</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;FCC&quot;</span><span class="p">])</span>
<span class="n">diffuser</span> <span class="o">=</span> <span class="n">OnsagerCalc</span><span class="o">.</span><span class="n">VacancyMediated</span><span class="p">(</span><span class="n">FCC</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">FCC</span><span class="o">.</span><span class="n">sitelist</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
                                       <span class="n">FCC</span><span class="o">.</span><span class="n">jumpnetwork</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.75</span><span class="o">*</span><span class="n">a0</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">diffuser</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Diffuser for atom 0 (FCC), Nthermo=1
#Lattice:
  a1 = [ 0.   0.5  0.5]
  a2 = [ 0.5  0.   0.5]
  a3 = [ 0.5  0.5  0. ]
#Basis:
  (FCC) 0.0 = [ 0.  0.  0.]
vacancy configurations:
v:+0.000,+0.000,+0.000
solute configurations:
s:+0.000,+0.000,+0.000
solute-vacancy configurations:
s:+0.000,+0.000,+0.000-v:-1.000,+0.000,+0.000
omega0 jumps:
omega0:v:+0.000,+0.000,+0.000^v:+1.000,+0.000,-1.000
omega1 jumps:
omega1:s:+0.000,+0.000,+0.000-v:+1.000,+0.000,-1.000^v:+2.000,+0.000,-2.000
omega1:s:+0.000,+0.000,+0.000-v:-1.000,+1.000,+0.000^v:+0.000,+1.000,-1.000
omega1:s:+0.000,+0.000,+0.000-v:+1.000,-1.000,+0.000^v:+2.000,-1.000,-1.000
omega1:s:+0.000,+0.000,+0.000-v:+0.000,-1.000,+0.000^v:+1.000,-1.000,-1.000
omega2 jumps:
omega2:s:+0.000,+0.000,+0.000-v:-1.000,+0.000,+1.000^s:+0.000,+0.000,+0.000-v:+1.000,+0.000,-1.000

</pre></div></div>
</div>
<p>Next, we fill out our thermodynamic dictionary.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tdict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;preV&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;eneV&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;preT0&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;eneT0&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">)}</span>
<span class="n">tdict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">diffuser</span><span class="o">.</span><span class="n">maketracerpreene</span><span class="p">(</span><span class="o">**</span><span class="n">tdict</span><span class="p">))</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">tdict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
preV [ 1.]
preT1 [ 1.  1.  1.  1.]
eneT2 [ 0.]
eneSV [ 0.]
preSV [ 1.]
eneV [ 0.]
eneT1 [ 0.  0.  0.  0.]
eneS [ 0.]
preT2 [ 1.]
preT0 [ 1.]
preS [ 1.]
eneT0 [ 0.]
</pre></div></div>
</div>
<p>Now, to loop through a range of <span class="math notranslate nohighlight">\(\omega^2\)</span> values from <span class="math notranslate nohighlight">\(10^{-17}\)</span> to <span class="math notranslate nohighlight">\(10^{17}\)</span>, and evaluate the <span class="math notranslate nohighlight">\(L_{\mathrm{ss}}\)</span> in three different ways:</p>
<ol class="arabic simple">
<li><p>Never using the large <span class="math notranslate nohighlight">\(\omega^2\)</span> treatment (should fail for large <span class="math notranslate nohighlight">\(\omega^2\)</span>).</p></li>
<li><p>Always using the large <span class="math notranslate nohighlight">\(\omega^2\)</span> treatment (should fail for small <span class="math notranslate nohighlight">\(\omega^2\)</span>).</p></li>
<li><p>Automatically switching treatment depending on <span class="math notranslate nohighlight">\(\omega^2\)</span> value (should be accurate over entire range).</p></li>
</ol>
<p>Because the failure can be pretty spectacular, we check for NaN, Inf, or 0 values.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;omega2</span><span class="se">\t</span><span class="s1">no large</span><span class="se">\t</span><span class="s1">all large</span><span class="se">\t</span><span class="s1">automatic&#39;</span><span class="p">)</span>
<span class="n">om2_list</span><span class="p">,</span> <span class="n">correl_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">om2pow</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">17</span><span class="p">,</span><span class="o">-</span><span class="mi">13</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="mi">17</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="mi">17</span><span class="p">))):</span>
    <span class="n">om2</span> <span class="o">=</span> <span class="mf">10.</span><span class="o">**</span><span class="p">(</span><span class="n">om2pow</span><span class="p">)</span>
    <span class="n">tdict</span><span class="p">[</span><span class="s1">&#39;preT2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">om2</span><span class="p">])</span>
    <span class="n">correl</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">large_om2</span> <span class="ow">in</span> <span class="p">(</span><span class="mf">1e33</span><span class="p">,</span> <span class="mf">1e-33</span><span class="p">,</span> <span class="mf">1e8</span><span class="p">):</span>
        <span class="n">Lss</span><span class="p">,</span> <span class="n">Lsv</span> <span class="o">=</span> <span class="n">diffuser</span><span class="o">.</span><span class="n">Lij</span><span class="p">(</span><span class="o">*</span><span class="n">diffuser</span><span class="o">.</span><span class="n">preene2betafree</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="o">**</span><span class="n">tdict</span><span class="p">),</span>
                                <span class="n">large_om2</span><span class="o">=</span><span class="n">large_om2</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Lsv</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="ow">or</span> <span class="n">Lsv</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span> <span class="ow">or</span> <span class="n">Lsv</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span> <span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="n">Lss</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">Lsv</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">correl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="n">om2_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">om2</span><span class="p">)</span>
    <span class="n">correl_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">correl</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;10^</span><span class="si">{:+.2f}</span><span class="se">\t</span><span class="si">{:.8e}</span><span class="se">\t</span><span class="si">{:.8e}</span><span class="se">\t</span><span class="si">{:.16e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">om2pow</span><span class="p">,</span>
                                                      <span class="n">correl</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">correl</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">correl</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
omega2  no large        all large       automatic
10^-17.00       7.81451419e-01  1.00000000e+00  7.8145141885543312e-01
10^-16.75       7.81451419e-01  1.00000000e+00  7.8145141885543312e-01
10^-16.50       7.81451419e-01  1.00000000e+00  7.8145141885543301e-01
10^-16.25       7.81451419e-01  1.00000000e+00  7.8145141885543301e-01
10^-16.00       7.81451419e-01  3.00239975e-01  7.8145141885543301e-01
10^-15.75       7.81451419e-01  5.33910566e-01  7.8145141885543312e-01
10^-15.50       7.81451419e-01  5.69665300e-01  7.8145141885543301e-01
10^-15.25       7.81451419e-01  8.44186728e-01  7.8145141885543312e-01
10^-15.00       7.81451419e-01  8.18836296e-01  7.8145141885543312e-01
10^-14.75       7.81451419e-01  7.62729380e-01  7.8145141885543312e-01
10^-14.50       7.81451419e-01  7.69817973e-01  7.8145141885543312e-01
10^-14.25       7.81451419e-01  7.79249287e-01  7.8145141885543301e-01
10^-14.00       7.81451419e-01  7.83234718e-01  7.8145141885543301e-01
10^-13.75       7.81451419e-01  7.81332535e-01  7.8145141885543312e-01
10^-13.50       7.81451419e-01  7.86830524e-01  7.8145141885543312e-01
10^-13.25       7.81451419e-01  7.81654377e-01  7.8145141885543312e-01
10^-13.00       7.81451419e-01  7.81874935e-01  7.8145141885543301e-01
10^+13.00       7.81383433e-01  7.81451419e-01  7.8145141885543312e-01
10^+13.25       7.81196581e-01  7.81451419e-01  7.8145141885543323e-01
10^+13.50       7.80341880e-01  7.81451419e-01  7.8145141885543312e-01
10^+13.75       7.81196581e-01  7.81451419e-01  7.8145141885543323e-01
10^+14.00       7.80068729e-01  7.81451419e-01  7.8145141885543312e-01
10^+14.25       7.76223776e-01  7.81451419e-01  7.8145141885543323e-01
10^+14.50       7.74647887e-01  7.81451419e-01  7.8145141885543323e-01
10^+14.75       7.71428571e-01  7.81451419e-01  7.8145141885543323e-01
10^+15.00       7.71428571e-01  7.81451419e-01  7.8145141885543301e-01
10^+15.25       7.77777778e-01  7.81451419e-01  7.8145141885543312e-01
10^+15.50       8.57142857e-01  7.81451419e-01  7.8145141885543312e-01
10^+15.75       1.00000000e+00  7.81451419e-01  7.8145141885543323e-01
10^+16.00       0.00000000e+00  7.81451419e-01  7.8145141885543323e-01
10^+16.25       1.00000000e+00  7.81451419e-01  7.8145141885543301e-01
10^+16.50       1.00000000e+00  7.81451419e-01  7.8145141885543301e-01
10^+16.75       1.00000000e+00  7.81451419e-01  7.8145141885543323e-01
10^+17.00       1.00000000e+00  7.81451419e-01  7.8145141885543323e-01
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">om2</span><span class="p">,</span> <span class="n">correl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">om2_list</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">correl_list</span><span class="p">)</span>
<span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">om2</span><span class="p">,</span> <span class="n">correl</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;automatic&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">om2</span><span class="p">,</span> <span class="n">correl</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;r.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;no large $\omega^2$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">om2</span><span class="p">,</span> <span class="n">correl</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;g.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;only large $\omega^2$&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mf">1e-17</span><span class="p">,</span><span class="mf">1e-13</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mf">1e13</span><span class="p">,</span><span class="mf">1e17</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">1.05</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">1.05</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$\omega^2$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;x-large&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$\omega^2$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;x-large&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;correlation&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;x-large&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.2</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
           <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;x-large&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_left</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelright</span><span class="o">=</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="n">d</span> <span class="o">=</span> <span class="mf">.015</span> <span class="c1"># how big to make the diagonal lines in axes coordinates</span>
<span class="c1"># arguments to pass plot, just so we don&#39;t keep repeating them</span>
<span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">transform</span><span class="o">=</span><span class="n">ax1</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">d</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="o">+</span><span class="n">d</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">d</span><span class="p">),(</span><span class="mi">1</span><span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">d</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">transform</span><span class="o">=</span><span class="n">ax2</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>  <span class="c1"># switch to the bottom axes</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="o">+</span><span class="n">d</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">d</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="o">+</span><span class="n">d</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="o">+</span><span class="n">d</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1"># plt.savefig(&#39;largeomega2.pdf&#39;, transparent=True, format=&#39;pdf&#39;)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_LargeOmega2_8_0.png" src="../_images/examples_LargeOmega2_8_0.png" />
</div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Garnet.html" class="btn btn-neutral float-left" title="Garnet correlation coefficients" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="NiSi.html" class="btn btn-neutral float-right" title="Si in FCC Ni" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017, Dallas R. Trinkle.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>