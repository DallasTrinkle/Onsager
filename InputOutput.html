

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Input and output for Onsager transport calculation &mdash; Onsager 1.3.3 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Example Notebooks" href="notebooks.html" />
    <link rel="prev" title="Onsager" href="includeme.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Onsager
          

          
          </a>

          
            
            
              <div class="version">
                1.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="includeme.html">Onsager</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Input and output for Onsager transport calculation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Assumptions-used-in-Onsager">Assumptions used in Onsager</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Crystal-class-setup">Crystal class setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Face-centered-cubic-crystal,-vacancy-diffusion">Face-centered cubic crystal, vacancy-diffusion</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Rocksalt-crystal,-vacancy-diffusion">Rocksalt crystal, vacancy-diffusion</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Face-centered-cubic-crystal,-interstitial-diffusion">Face-centered cubic crystal, interstitial diffusion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Interstitial-calculator-setup">Interstitial calculator setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Face-centered-cubic-crystal,-vacancy-diffusion">Face-centered cubic crystal, vacancy-diffusion</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Rocksalt-crystal,-vacancy-diffusion">Rocksalt crystal, vacancy-diffusion</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Face-centered-cubic-crystal,-interstitial-diffusion">Face-centered cubic crystal, interstitial diffusion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Vacancy-mediated-calculator-setup">Vacancy-mediated calculator setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Face-centered-cubic-crystal,-vacancy-mediated-diffusion">Face-centered cubic crystal, vacancy mediated-diffusion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#VASP-style-input-files">VASP-style input files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Face-centered-cubic-crystal,-interstitial-diffusion">Face-centered cubic crystal, interstitial diffusion</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Face-centered-cubic-crystal,-vacancy-mediated-diffusion">Face-centered cubic crystal, vacancy mediated-diffusion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Formatting-of-input-data">Formatting of input data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Face-centered-cubic-crystal,-interstitial-diffusion">Face-centered cubic crystal, interstitial diffusion</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Face-centered-cubic-crystal,-vacancy-mediated-diffusion">Face-centered cubic crystal, vacancy mediated-diffusion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Interpretation-of-output">Interpretation of output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Interstitial-diffusivity">Interstitial diffusivity</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Derivatives-of-diffusivity:-activation-barrier-tensor">Derivatives of diffusivity: activation barrier tensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Derivatives-of-diffusivity:-elastodiffusion-and-activation-volume-tensor">Derivatives of diffusivity: elastodiffusion and activation volume tensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Vacancy-mediated-diffusivity">Vacancy-mediated diffusivity</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Drag-ratio">Drag ratio</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Solute-diffusivity-in-the-dilute-limit">Solute diffusivity in the dilute limit</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="notebooks.html">Example Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Modules</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Onsager</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Input and output for Onsager transport calculation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/InputOutput.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Input-and-output-for-Onsager-transport-calculation">
<h1>Input and output for Onsager transport calculation<a class="headerlink" href="#Input-and-output-for-Onsager-transport-calculation" title="Permalink to this headline">¶</a></h1>
<p>The Onsager calculators currently include two computational approaches to determining transport coefficients: an “interstitial” calculation, and a “vacancy-mediated” calculator. Below we describe the</p>
<ol class="arabic simple" start="0">
<li><p><strong>Assumptions used in transport model</strong> that are necessary to understand the data to be input, and the limitations of the results;</p></li>
<li><p><strong>Crystal class setup</strong> needed to initiate a calculation;</p></li>
<li><p><strong>Interstitial calculator setup</strong> needed for an single mobile species calculation, or,</p></li>
<li><p><strong>Vacancy-mediated calculator setup</strong> needed for a vacancy-mediated substitutional solute calculation;</p></li>
<li><p>the creation of <strong>VASP-style input files</strong> to be run to generate input data;</p></li>
<li><p>proper <strong>Formatting of input data</strong> to be compatible with the calculators; and</p></li>
<li><p><strong>Interpretation of output</strong> which includes how to convert output into transport coefficients.</p></li>
</ol>
<p>This follows the overall structure of a transport coefficient calculation. Broadly speaking, these are the steps necessary to compute transport coefficients:</p>
<ol class="arabic simple">
<li><p>Identify the crystal to be considered; this requires mapping whatever defects are to be considered mobile onto appropriate Wyckoff sites in the crystal, even if those exact sites are not occupied by true atoms.</p></li>
<li><p>Generate lists of symmetry unrelated “defect states” and “defect state transitions,” along with the appropriate “calculator object.”</p></li>
<li><p>Construct input files for total energy calculations to be run outside of the Onsager codebase; extract appropriate energy and frequency information from those runs.</p></li>
<li><p>Input the data in a format that the calculator can understand, and transform those energies and frequencies into rates at a given temperature assuming Arrhenius behavior.</p></li>
<li><p>Transform the output into physically relevant quantities (Onsager coefficients, solute diffusivities, mobilities, or drag ratios) with appropriate units.</p></li>
</ol>
<div class="section" id="Assumptions-used-in-Onsager">
<h2>Assumptions used in Onsager<a class="headerlink" href="#Assumptions-used-in-Onsager" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Onsager</span></code> code computes transport of defects on an infinite crystalline lattice. Currently, the code requires that the particular defects can be mapped onto Wyckoff positions in a crystal. This does not <em>require</em> that the defect be an atom occupying various Wyckoff positions (though that obviously is captured), but merely that the defect have the symmetry and transitions that can be equivalently described by an “object” that occupies Wyckoff positions. Simple examples include vacancies,
substitutional solutes, simple interstitial atoms, as well as more complex cases such as split vacancy defects (e.g.: a V-O<span class="math notranslate nohighlight">\(_\text{i}\)</span>-V split double vacancy with oxygen interstitial in a closed-packed crystal; the entire defect complex can be mapped on to the Wyckoff position of the oxygen interstitial). In order to calculate diffusion, a few assumptions are made:</p>
<ul class="simple">
<li><p><strong>defects are dilute:</strong> we never consider more than one defect at a time in an “infinite” periodic crystal; the vacancy-mediated diffuser uses one vacancy and one solute.</p></li>
<li><p><strong>defects diffuse via a Markovian process</strong>: defect states are well-defined, and the transition time from state-to-state is much longer than the equilibration time in a state, so that the evolution of the system is described by the Master equation with time-independent rates.</p></li>
<li><p><strong>defects do not alter the underlying symmetry of the crystal</strong>: while the defect itself can have a lower symmetry (according to its Wyckoff position), the presence of a defect does not lead to a global phase transformation to a different crystal; moreover, the crystal maintains translational invariance so that the energy of the system with defect(s) is unchanged under translations.</p></li>
</ul>
<p>All of these assumptions are usually good: the dilute limit is valid without strong interactions (such as site blocking), Markovian processes are valid as long as barriers are a few times <span class="math notranslate nohighlight">\(k_\text{B}T\)</span>, and we are not currently aware of any (simple) defects that induce phase transformations.</p>
<p>Furthermore, relaxation around a defect (or defect cluster) is allowed, but the assumption is that all of the atomic positions can be easily mapped back to “perfect” crystal lattice sites. This is an “off-lattice” model. In some cases, it can be possible to incorporate “new” states, especially metastable states, that are only accessible by a defect.</p>
<p>Finally, the code requires that all diffusion happens on a single sublattice. This sublattice is defined by a single chemical species; it can include multiple Wyckoff positions. But the current algorithms assume that transitions do not result in the creation of <em>antisite defects</em> (where a chemical species is on an “incorrect” sublattice).</p>
</div>
<div class="section" id="Crystal-class-setup">
<h2>Crystal class setup<a class="headerlink" href="#Crystal-class-setup" title="Permalink to this headline">¶</a></h2>
<p>The assumption of translational invariance of our defects is captured by the use of a <code class="docutils literal notranslate"><span class="pre">Crystal</span></code> object. Following the standard definition of a crystal, we need to specify (a) three lattice vectors, and (b) at least one basis position, corresponding to at least one site. The crystal needs to contain <em>at least</em> the Wyckoff positions on a single sublattice corresponding to the diffusing defects. It can be useful for it to contain <em>more</em> atoms that act as “spectator” atoms: they do not participate
in diffusion, but define both the underlying symmetry of the crystal, and if atomic-scale calculations will be used to compute configuration and transition-state energies, are necessary to define the energy landscape of diffusion.</p>
<p>The lattice vectors of the underlying crystal set the units of <em>length</em> in the transport coefficients. Hence, if the vectors are entered in units of nm, this corresponds to a factor of <span class="math notranslate nohighlight">\(10^{-18}\text{ m}^2\)</span> in the transport coefficients. This should also be considered when including factors of volume per atom as well.</p>
<ul class="simple">
<li><p>The <em>lattice vectors</em> are given by three vectors, <span class="math notranslate nohighlight">\(\mathbf{a}_1\)</span>, <span class="math notranslate nohighlight">\(\mathbf{a}_2\)</span>, <span class="math notranslate nohighlight">\(\mathbf{a}_3\)</span> in Cartesian coordinates. In python, these are input when creating a Crystal either as a list of three <code class="docutils literal notranslate"><span class="pre">numpy</span></code> vectors, <em>or</em> as a square <code class="docutils literal notranslate"><span class="pre">numpy</span></code> matrix. <strong>Note:</strong> if you enter the three vectors as a matrix, remember that <strong>it assumes the vectors are column vectors</strong>. That is, if <code class="docutils literal notranslate"><span class="pre">amat</span></code> is the matrix, then <code class="docutils literal notranslate"><span class="pre">amat[:,0]</span></code> is <span class="math notranslate nohighlight">\(\mathbf{a}_1\)</span>, <code class="docutils literal notranslate"><span class="pre">amat[:,1]</span></code> is
<span class="math notranslate nohighlight">\(\mathbf{a}_2\)</span>, and <code class="docutils literal notranslate"><span class="pre">amat[:,2]</span></code> is <span class="math notranslate nohighlight">\(\mathbf{a}_3\)</span>. <strong>This may not be what you’re expecting.</strong> The main recommendation is to enter the lattice vectors as a list (or tuple) of three <code class="docutils literal notranslate"><span class="pre">numpy</span></code> vectors.</p></li>
<li><p>The <em>atomic basis</em> is given by a <em>list</em> of <em>lists</em> of <code class="docutils literal notranslate"><span class="pre">numpy</span></code> vectors of positions in <em>unit cell coordinates</em>. For a given <code class="docutils literal notranslate"><span class="pre">basis</span></code>, then <code class="docutils literal notranslate"><span class="pre">basis[0]</span></code> is a list of all positions for the first chemical element in the crystal, <code class="docutils literal notranslate"><span class="pre">basis[1]</span></code> is the second chemical element, and so on. <strong>If you only have a single chemical element, you may enter a list of ``numpy`` vectors.</strong></p></li>
<li><p>An optional <em>spin</em> degree of freedom can be included. This is a list of objects, with one for each chemical element. These can be either scalar or vectors, with the assumption that they transform as those objects under group operations. If not included, the spins are all assumed to be equal to 0. Inclusion of these additional degrees of freedom (currently) only impacts the reduction of the unit cell, and the construction of the space group operations.</p></li>
<li><p>We also take in, strictly for bookkeeping purposes, a list of names for the chemical elements. <em>This is an optional input</em>, but recommended for readability.</p></li>
</ul>
<p>Once initialized, two main internal operations take place:</p>
<ol class="arabic simple">
<li><p>The unit cell is <em>reduced</em> and <em>optimized</em>. Reduction is a process where we try to find the smallest unit cell representation for the <code class="docutils literal notranslate"><span class="pre">Crystal</span></code>. This means that the four-atom “simple cubic” unit cell of face-centered cubic can be input, and the code will reduce it to the standard single-atom primitive cell. The reduction algorithm can end up with “unusual” choices of lattice vectors, so we also optimize the lattice vectors so that they are as close to orthogonal as possible, and ordered
from smallest to largest. The atomic basis may be shifted uniformly so that <em>if</em> an inversion operation is present, then the inversion center is the origin. Neither choice changes the representation of the crystal; however, the <em>reduction</em> operation can be skipped by including the option <code class="docutils literal notranslate"><span class="pre">noreduce=True</span></code>.</p></li>
<li><p>Full symmetry analysis is performed, including: automated construction of space group generator operators, partitioning of basis sites into symmetry related Wyckoff positions, and determination of point group operations for every basis site. All of these operations are automated, and make no reference to crystallographic tables. The algorithm cannot identify which space group it has generated, nor which Wyckoff positions are present. The algorithm respects both <em>chemistry</em> and <em>spin</em>; this
also makes spin a useful manipulation tool to artificially lower symmetry for testing purposes as needed.</p></li>
</ol>
<p><strong>Note</strong>: <code class="docutils literal notranslate"><span class="pre">Crystal</span></code>s can also be constructed by manipulating existing <code class="docutils literal notranslate"><span class="pre">Crystal</span></code> objects. A useful case is for the interstitial diffuser: when working “interactively,” it is often easier to first make the underlying “spectator” crystal, and then have that <code class="docutils literal notranslate"><span class="pre">Crystal</span></code> construct the set of Wyckoff positions for a single site in the crystal, and then add that to the basis. <code class="docutils literal notranslate"><span class="pre">Crystal</span></code> objects are intended to be read-only, so these manipulations result in the creation of a new <code class="docutils literal notranslate"><span class="pre">Crystal</span></code>
object.</p>
<p>A few quick examples:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;..&#39;</span><span class="p">])</span>
<span class="kn">from</span> <span class="nn">onsager</span> <span class="kn">import</span> <span class="n">crystal</span>
</pre></div>
</div>
</div>
<div class="section" id="Face-centered-cubic-crystal,-vacancy-diffusion">
<h3>Face-centered cubic crystal, vacancy-diffusion<a class="headerlink" href="#Face-centered-cubic-crystal,-vacancy-diffusion" title="Permalink to this headline">¶</a></h3>
<p>Face-centered cubic crystals could be created either by entering the primitive basis:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">a0</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">FCCcrys</span> <span class="o">=</span> <span class="n">crystal</span><span class="o">.</span><span class="n">Crystal</span><span class="p">([</span><span class="n">a0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">]),</span>
                           <span class="n">a0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">]),</span>
                           <span class="n">a0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">0</span><span class="p">])],</span>
                          <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">])],</span> <span class="n">chemistry</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fcc&#39;</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">FCCcrys</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
#Lattice:
  a1 = [ 0.   0.5  0.5]
  a2 = [ 0.5  0.   0.5]
  a3 = [ 0.5  0.5  0. ]
#Basis:
  (fcc) 0.0 = [ 0.  0.  0.]
</pre></div></div>
</div>
<p>or by entering the simple cubic unit cell with four atoms:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">FCCcrys2</span> <span class="o">=</span> <span class="n">crystal</span><span class="o">.</span><span class="n">Crystal</span><span class="p">(</span><span class="n">a0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
                           <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">]),</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">0</span><span class="p">])],</span>
                           <span class="n">chemistry</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fcc&#39;</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">FCCcrys2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
#Lattice:
  a1 = [ 0.5  0.   0.5]
  a2 = [ 0.   0.5  0.5]
  a3 = [-0.5  0.   0.5]
#Basis:
  (fcc) 0.0 = [ 0.  0.  0.]
</pre></div></div>
</div>
<p>The effect of <code class="docutils literal notranslate"><span class="pre">noreduce</span></code> can be seen by regenerating the FCC crystal using the simple cubic unit cell:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">FCCcrys3</span> <span class="o">=</span> <span class="n">crystal</span><span class="o">.</span><span class="n">Crystal</span><span class="p">(</span><span class="n">a0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
                           <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">]),</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">0</span><span class="p">])],</span>
                           <span class="n">chemistry</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fcc&#39;</span><span class="p">],</span> <span class="n">noreduce</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">FCCcrys3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
#Lattice:
  a1 = [ 1.  0.  0.]
  a2 = [ 0.  1.  0.]
  a3 = [ 0.  0.  1.]
#Basis:
  (fcc) 0.0 = [ 0.  0.  0.]
  (fcc) 0.1 = [ 0.   0.5  0.5]
  (fcc) 0.2 = [ 0.5  0.   0.5]
  (fcc) 0.3 = [ 0.5  0.5  0. ]
</pre></div></div>
</div>
</div>
<div class="section" id="Rocksalt-crystal,-vacancy-diffusion">
<h3>Rocksalt crystal, vacancy-diffusion<a class="headerlink" href="#Rocksalt-crystal,-vacancy-diffusion" title="Permalink to this headline">¶</a></h3>
<p>Two chemical species, with interpenetrating FCC lattices. In MgO, we would allow for V<span class="math notranslate nohighlight">\(_\text{O}\)</span> (oxygen vacancies) to diffuse, with Mg as a “spectator species”:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">MgO</span> <span class="o">=</span> <span class="n">crystal</span><span class="o">.</span><span class="n">Crystal</span><span class="p">([</span><span class="n">a0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">]),</span>
                       <span class="n">a0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">]),</span>
                       <span class="n">a0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">0</span><span class="p">])],</span>
                      <span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">])],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">])]],</span>
                      <span class="n">chemistry</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Mg&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">MgO</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
#Lattice:
  a1 = [ 0.   0.5  0.5]
  a2 = [ 0.5  0.   0.5]
  a3 = [ 0.5  0.5  0. ]
#Basis:
  (Mg) 0.0 = [ 0.  0.  0.]
  (O) 1.0 = [ 0.5  0.5  0.5]
</pre></div></div>
</div>
</div>
<div class="section" id="Face-centered-cubic-crystal,-interstitial-diffusion">
<h3>Face-centered cubic crystal, interstitial diffusion<a class="headerlink" href="#Face-centered-cubic-crystal,-interstitial-diffusion" title="Permalink to this headline">¶</a></h3>
<p>Interstitials in FCC crystals usually diffuse through a network of octahedral and tetrahedral sites. We can use the <code class="docutils literal notranslate"><span class="pre">Wyckoffpos(u)</span></code> function in a crystal to generate a list of equivalent sites corresponding to the interstitial positions, and the <code class="docutils literal notranslate"><span class="pre">addbasis()</span></code> function to create a new crystal with these interstitial sites.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">octbasis</span> <span class="o">=</span> <span class="n">FCCcrys</span><span class="o">.</span><span class="n">Wyckoffpos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]))</span>
<span class="n">tetbasis</span> <span class="o">=</span> <span class="n">FCCcrys</span><span class="o">.</span><span class="n">Wyckoffpos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">]))</span>
<span class="n">FCCcrysint</span> <span class="o">=</span> <span class="n">FCCcrys</span><span class="o">.</span><span class="n">addbasis</span><span class="p">(</span><span class="n">octbasis</span> <span class="o">+</span> <span class="n">tetbasis</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;int&#39;</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">octbasis</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">tetbasis</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">FCCcrysint</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[array([ 0.5,  0.5,  0.5])]
[array([ 0.75,  0.75,  0.75]), array([ 0.25,  0.25,  0.25])]
#Lattice:
  a1 = [ 0.   0.5  0.5]
  a2 = [ 0.5  0.   0.5]
  a3 = [ 0.5  0.5  0. ]
#Basis:
  (fcc) 0.0 = [ 0.  0.  0.]
  (int) 1.0 = [ 0.5  0.5  0.5]
  (int) 1.1 = [ 0.75  0.75  0.75]
  (int) 1.2 = [ 0.25  0.25  0.25]
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Interstitial-calculator-setup">
<h2>Interstitial calculator setup<a class="headerlink" href="#Interstitial-calculator-setup" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Interstitial</span></code> calculator is designed for systems where we have a <strong>single defect species</strong> that diffuses throughout the crystal. This includes single vacancy diffusion, and interstitial solute diffusivity. As for any diffusion calculator, we need to define the configurations that the defect will sample, and the transition states of the defect. In the case of a single defect species,</p>
<ul class="simple">
<li><p>configurations are simply the Wyckoff positions of the particular sublattice (specified by a <code class="docutils literal notranslate"><span class="pre">chemistry</span></code> index);</p></li>
<li><p>transition states are pairs of configurations with a displacement vector that connects the initial to the final system.</p></li>
</ul>
<p>We use the <code class="docutils literal notranslate"><span class="pre">sitelist(chemistry)</span></code> function to construct a <em>list</em> of <em>lists</em> of indices for a given <code class="docutils literal notranslate"><span class="pre">chemistry</span></code>; the lists of indices are all symmetrically equivalent crystal basis indices, and each list is symmetrically inequivalent: this is a space group partitioning into equivalent Wyckoff positions.</p>
<p>The transition states are stored as a <code class="docutils literal notranslate"><span class="pre">jumpnetwork</span></code>, which is a <em>list</em> of <em>lists</em> of <em>tuples</em> of transitions: <code class="docutils literal notranslate"><span class="pre">(initial</span> <span class="pre">index,</span> <span class="pre">final</span> <span class="pre">index,</span> <span class="pre">deltax)</span></code> where the indices are self-explanatory, and <code class="docutils literal notranslate"><span class="pre">deltax</span></code> is a Cartesian vector corresponding to the translation from the initial state to the final state. The transitions in each list is equivalent by symmetry, and the separate lists are symmetrically inequivalent. Note also that <em>reverse</em> transitions are included:
<code class="docutils literal notranslate"><span class="pre">(final</span> <span class="pre">index,</span> <span class="pre">initial</span> <span class="pre">index,</span> <span class="pre">-deltax)</span></code>. While the jumpnetwork can be constructed “by hand,” it is recommended to use the <code class="docutils literal notranslate"><span class="pre">jumpnetwork()</span></code> function inside of a crystal to automate the generation, and then remove “spurious” transitions that are identified.</p>
<p>The algorithm in <code class="docutils literal notranslate"><span class="pre">jumpnetwork()</span></code> is rather simple: a transition is included if</p>
<ul class="simple">
<li><p>the distance between the initial and final state is less than a cutoff distance, and</p></li>
<li><p>the line segment between the initial and final state does not come within a minimum distance of other defect states, and</p></li>
<li><p>the line segment between the initial and final state does not come within a minimum distance of <em>any</em> atomic site in the crystal.</p></li>
</ul>
<p>The first criterion identifies “close” jumps, while the second criterion eliminates “long” transitions between states when an intermediate configuration may be possible (i.e., <span class="math notranslate nohighlight">\(\text{A}\to\text{B}\)</span> when <span class="math notranslate nohighlight">\(\text{A}\to\text{C}\to\text{B}\)</span> would be more likely as the state C is “close” to the line connecting A to B), and the final criterion elimates transitions that takes the defect too close to a “spectator” atom in the crystal.</p>
<p>The interstitial diffuser also identifies unique <strong>tags</strong> for all configurations and transition states. The interstitial tags for <em>configurations</em> are strings with <code class="docutils literal notranslate"><span class="pre">i:</span></code> followed by unit cell coordinates of site to three decimal digits. The interstitial tags for <em>transition states</em> are strings with <code class="docutils literal notranslate"><span class="pre">i:</span></code> followed by the unit cell coordinates of the initial state, a <code class="docutils literal notranslate"><span class="pre">^</span></code>, and the unit cell coordinates of the final state. When one pretty-prints the interstitial diffuser object, the symmetry
unique tags are printed. Note that all of the symmetry equivalent tags are stored in the object, and can be used to identify configurations and transition states, and this is the preferred method for indexing, rather than relying on the particular index into the corresponding lists. The interstitial diffuser calculator contains dictionaries that can be used to convert from tags to indices and vice versa.</p>
<p>Finally, <code class="docutils literal notranslate"><span class="pre">YAML</span></code> interfaces to output the <code class="docutils literal notranslate"><span class="pre">sitelist</span></code> and <code class="docutils literal notranslate"><span class="pre">jumpnetwork</span></code> for an interstitial diffuser are includes; combined with the <code class="docutils literal notranslate"><span class="pre">YAML</span></code> output of the Crystal, this allows for a <code class="docutils literal notranslate"><span class="pre">YAML</span></code> serialized representation of the diffusion object.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">onsager</span> <span class="kn">import</span> <span class="n">OnsagerCalc</span>
</pre></div>
</div>
</div>
<div class="section" id="Face-centered-cubic-crystal,-vacancy-diffusion">
<h3>Face-centered cubic crystal, vacancy-diffusion<a class="headerlink" href="#Face-centered-cubic-crystal,-vacancy-diffusion" title="Permalink to this headline">¶</a></h3>
<p>We identify the vacancy sites with the crystal sites in the lattice.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">chem</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">FCCsitelist</span> <span class="o">=</span> <span class="n">FCCcrys</span><span class="o">.</span><span class="n">sitelist</span><span class="p">(</span><span class="n">chem</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">FCCsitelist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[0]]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">chem</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">FCCjumpnetwork</span> <span class="o">=</span> <span class="n">FCCcrys</span><span class="o">.</span><span class="n">jumpnetwork</span><span class="p">(</span><span class="n">chem</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="n">a0</span><span class="o">*</span><span class="mf">0.78</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">jn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">FCCjumpnetwork</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Jump type {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">),</span> <span class="n">dx</span> <span class="ow">in</span> <span class="n">jn</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;  {} -&gt; {} dx= {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">dx</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Jump type 0
  0 -&gt; 0 dx= [ 0.  -0.5 -0.5]
  0 -&gt; 0 dx= [-0.   0.5  0.5]
  0 -&gt; 0 dx= [ 0.5  0.   0.5]
  0 -&gt; 0 dx= [-0.5 -0.  -0.5]
  0 -&gt; 0 dx= [ 0.5  0.  -0.5]
  0 -&gt; 0 dx= [-0.5 -0.   0.5]
  0 -&gt; 0 dx= [ 0.  -0.5  0.5]
  0 -&gt; 0 dx= [-0.   0.5 -0.5]
  0 -&gt; 0 dx= [-0.5  0.5  0. ]
  0 -&gt; 0 dx= [ 0.5 -0.5 -0. ]
  0 -&gt; 0 dx= [-0.5 -0.5  0. ]
  0 -&gt; 0 dx= [ 0.5  0.5 -0. ]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">chem</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">FCCvacancydiffuser</span> <span class="o">=</span> <span class="n">OnsagerCalc</span><span class="o">.</span><span class="n">Interstitial</span><span class="p">(</span><span class="n">FCCcrys</span><span class="p">,</span> <span class="n">chem</span><span class="p">,</span> <span class="n">FCCsitelist</span><span class="p">,</span> <span class="n">FCCjumpnetwork</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">FCCvacancydiffuser</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Diffuser for atom 0 (fcc)
#Lattice:
  a1 = [ 0.   0.5  0.5]
  a2 = [ 0.5  0.   0.5]
  a3 = [ 0.5  0.5  0. ]
#Basis:
  (fcc) 0.0 = [ 0.  0.  0.]
states:
i:+0.000,+0.000,+0.000
transitions:
i:+0.000,+0.000,+0.000^i:-1.000,+0.000,+0.000

</pre></div></div>
</div>
</div>
<div class="section" id="Rocksalt-crystal,-vacancy-diffusion">
<h3>Rocksalt crystal, vacancy-diffusion<a class="headerlink" href="#Rocksalt-crystal,-vacancy-diffusion" title="Permalink to this headline">¶</a></h3>
<p>Two chemical species, with interpenetrating FCC lattices. In MgO, we would allow for V<span class="math notranslate nohighlight">\(_\text{O}\)</span> (oxygen vacancies) to diffuse, with Mg as a “spectator species”.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">chem</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">MgOsitelist</span> <span class="o">=</span> <span class="n">MgO</span><span class="o">.</span><span class="n">sitelist</span><span class="p">(</span><span class="n">chem</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">MgOsitelist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[0]]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">chem</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">MgOjumpnetwork</span> <span class="o">=</span> <span class="n">MgO</span><span class="o">.</span><span class="n">jumpnetwork</span><span class="p">(</span><span class="n">chem</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="n">a0</span><span class="o">*</span><span class="mf">0.78</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">jn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">MgOjumpnetwork</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Jump type {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">),</span> <span class="n">dx</span> <span class="ow">in</span> <span class="n">jn</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;  {} -&gt; {} dx= {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">dx</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Jump type 0
  0 -&gt; 0 dx= [ 0.   0.5 -0.5]
  0 -&gt; 0 dx= [-0.  -0.5  0.5]
  0 -&gt; 0 dx= [-0.5  0.   0.5]
  0 -&gt; 0 dx= [ 0.5 -0.  -0.5]
  0 -&gt; 0 dx= [ 0.  -0.5 -0.5]
  0 -&gt; 0 dx= [-0.   0.5  0.5]
  0 -&gt; 0 dx= [-0.5 -0.5  0. ]
  0 -&gt; 0 dx= [ 0.5  0.5 -0. ]
  0 -&gt; 0 dx= [-0.5  0.  -0.5]
  0 -&gt; 0 dx= [ 0.5 -0.   0.5]
  0 -&gt; 0 dx= [-0.5  0.5  0. ]
  0 -&gt; 0 dx= [ 0.5 -0.5 -0. ]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">chem</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">MgOdiffuser</span> <span class="o">=</span> <span class="n">OnsagerCalc</span><span class="o">.</span><span class="n">Interstitial</span><span class="p">(</span><span class="n">MgO</span><span class="p">,</span> <span class="n">chem</span><span class="p">,</span> <span class="n">MgOsitelist</span><span class="p">,</span> <span class="n">MgOjumpnetwork</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">MgOdiffuser</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Diffuser for atom 1 (O)
#Lattice:
  a1 = [ 0.   0.5  0.5]
  a2 = [ 0.5  0.   0.5]
  a3 = [ 0.5  0.5  0. ]
#Basis:
  (Mg) 0.0 = [ 0.  0.  0.]
  (O) 1.0 = [ 0.5  0.5  0.5]
states:
i:+0.500,+0.500,+0.500
transitions:
i:+0.500,+0.500,+0.500^i:+0.500,-0.500,+1.500

</pre></div></div>
</div>
</div>
<div class="section" id="Face-centered-cubic-crystal,-interstitial-diffusion">
<h3>Face-centered cubic crystal, interstitial diffusion<a class="headerlink" href="#Face-centered-cubic-crystal,-interstitial-diffusion" title="Permalink to this headline">¶</a></h3>
<p>Interstitials in FCC crystals usually diffuse through a network of octahedral and tetrahedral sites. Nominally, diffusion should occur through an octahedral-tetrahedral jumps, but we can extend the cutoff distance to find additinoal jumps between tetrahedrals.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">chem</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">FCCintsitelist</span> <span class="o">=</span> <span class="n">FCCcrysint</span><span class="o">.</span><span class="n">sitelist</span><span class="p">(</span><span class="n">chem</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">FCCintsitelist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[0], [1, 2]]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">chem</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">FCCintjumpnetwork</span> <span class="o">=</span> <span class="n">FCCcrysint</span><span class="o">.</span><span class="n">jumpnetwork</span><span class="p">(</span><span class="n">chem</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="n">a0</span><span class="o">*</span><span class="mf">0.51</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">jn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">FCCintjumpnetwork</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Jump type {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">),</span> <span class="n">dx</span> <span class="ow">in</span> <span class="n">jn</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;  {} -&gt; {} dx= {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">dx</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Jump type 0
  0 -&gt; 2 dx= [ 0.25 -0.25  0.25]
  2 -&gt; 0 dx= [-0.25  0.25 -0.25]
  0 -&gt; 1 dx= [-0.25  0.25 -0.25]
  1 -&gt; 0 dx= [ 0.25 -0.25  0.25]
  0 -&gt; 2 dx= [-0.25  0.25  0.25]
  2 -&gt; 0 dx= [ 0.25 -0.25 -0.25]
  0 -&gt; 2 dx= [-0.25 -0.25 -0.25]
  2 -&gt; 0 dx= [ 0.25  0.25  0.25]
  0 -&gt; 2 dx= [ 0.25  0.25 -0.25]
  2 -&gt; 0 dx= [-0.25 -0.25  0.25]
  0 -&gt; 1 dx= [ 0.25 -0.25 -0.25]
  1 -&gt; 0 dx= [-0.25  0.25  0.25]
  0 -&gt; 1 dx= [-0.25 -0.25  0.25]
  1 -&gt; 0 dx= [ 0.25  0.25 -0.25]
  0 -&gt; 1 dx= [ 0.25  0.25  0.25]
  1 -&gt; 0 dx= [-0.25 -0.25 -0.25]
Jump type 1
  2 -&gt; 1 dx= [ 0.   0.   0.5]
  1 -&gt; 2 dx= [-0.  -0.  -0.5]
  2 -&gt; 1 dx= [ 0.  -0.5  0. ]
  1 -&gt; 2 dx= [-0.   0.5 -0. ]
  2 -&gt; 1 dx= [-0.5  0.   0. ]
  1 -&gt; 2 dx= [ 0.5 -0.  -0. ]
  2 -&gt; 1 dx= [ 0.   0.5  0. ]
  1 -&gt; 2 dx= [-0.  -0.5 -0. ]
  2 -&gt; 1 dx= [ 0.5  0.   0. ]
  1 -&gt; 2 dx= [-0.5 -0.  -0. ]
  2 -&gt; 1 dx= [ 0.   0.  -0.5]
  1 -&gt; 2 dx= [-0.  -0.   0.5]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">chem</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">FCCintdiffuser</span> <span class="o">=</span> <span class="n">OnsagerCalc</span><span class="o">.</span><span class="n">Interstitial</span><span class="p">(</span><span class="n">FCCcrysint</span><span class="p">,</span> <span class="n">chem</span><span class="p">,</span>
                                          <span class="n">FCCintsitelist</span><span class="p">,</span> <span class="n">FCCintjumpnetwork</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">FCCintdiffuser</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Diffuser for atom 1 (int)
#Lattice:
  a1 = [ 0.   0.5  0.5]
  a2 = [ 0.5  0.   0.5]
  a3 = [ 0.5  0.5  0. ]
#Basis:
  (fcc) 0.0 = [ 0.  0.  0.]
  (int) 1.0 = [ 0.5  0.5  0.5]
  (int) 1.1 = [ 0.75  0.75  0.75]
  (int) 1.2 = [ 0.25  0.25  0.25]
states:
i:+0.500,+0.500,+0.500
i:+0.750,+0.750,+0.750
transitions:
i:+0.500,+0.500,+0.500^i:+0.250,+1.250,+0.250
i:+0.250,+0.250,+0.250^i:+0.750,+0.750,-0.250

</pre></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">YAML</span></code> representation is intended to combine both the structural information necessary to construct the (1) crystal, (2) chemistry index of the diffusing defect, (3) sitelist, and (4) jumpnetwork; <strong>and</strong> the energies, prefactors, and elastic dipoles (derivative of energy with respect to strain) for the symmetry representatives of configurations and jumps. This will become input for the diffuser when computing transport coefficients as a function of temperature, as well as derivatives with
respect to strain (elastodiffusion tensor, activation volume tensor).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="n">FCCintdiffuser</span><span class="o">.</span><span class="n">crys</span><span class="o">.</span><span class="n">simpleYAML</span><span class="p">()</span> <span class="o">+</span>
      <span class="s1">&#39;chem: {}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">FCCintdiffuser</span><span class="o">.</span><span class="n">chem</span><span class="p">)</span> <span class="o">+</span>
      <span class="n">FCCintdiffuser</span><span class="o">.</span><span class="n">sitelistYAML</span><span class="p">(</span><span class="n">FCCintsitelist</span><span class="p">)</span> <span class="o">+</span>
      <span class="n">FCCintdiffuser</span><span class="o">.</span><span class="n">jumpnetworkYAML</span><span class="p">(</span><span class="n">FCCintjumpnetwork</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
basis:
- - !numpy.ndarray [0.0, 0.0, 0.0]
- - !numpy.ndarray [0.5, 0.5, 0.5]
  - !numpy.ndarray [0.75, 0.75, 0.75]
  - !numpy.ndarray [0.25, 0.25, 0.25]
chemistry: [fcc, int]
lattice: !numpy.ndarray
- [0.0, 0.5, 0.5]
- [0.5, 0.0, 0.5]
- [0.5, 0.5, 0.0]
lattice_constant: 1.0
spins: null
threshold: 1.0e-08
chem: 1
Dipole:
- !numpy.ndarray
  - [0.0, 0.0, 0.0]
  - [0.0, 0.0, 0.0]
  - [0.0, 0.0, 0.0]
- !numpy.ndarray
  - [0.0, 0.0, 0.0]
  - [0.0, 0.0, 0.0]
  - [0.0, 0.0, 0.0]
Energy: [0, 0]
Prefactor: [1, 1]
sitelist:
- [0]
- [1, 2]
DipoleT:
- !numpy.ndarray
  - [0.0, 0.0, 0.0]
  - [0.0, 0.0, 0.0]
  - [0.0, 0.0, 0.0]
- !numpy.ndarray
  - [0.0, 0.0, 0.0]
  - [0.0, 0.0, 0.0]
  - [0.0, 0.0, 0.0]
EnergyT: [0, 0]
PrefactorT: [1, 1]
jumpnetwork:
- - !!python/tuple
    - !!python/tuple [0, 2]
    - !numpy.ndarray [0.25, -0.25, 0.25]
  - !!python/tuple
    - !!python/tuple [2, 0]
    - !numpy.ndarray [-0.25, 0.25, -0.25]
  - !!python/tuple
    - !!python/tuple [0, 1]
    - !numpy.ndarray [-0.25, 0.25, -0.25]
  - !!python/tuple
    - !!python/tuple [1, 0]
    - !numpy.ndarray [0.25, -0.25, 0.25]
  - !!python/tuple
    - !!python/tuple [0, 2]
    - !numpy.ndarray [-0.25, 0.25, 0.25]
  - !!python/tuple
    - !!python/tuple [2, 0]
    - !numpy.ndarray [0.25, -0.25, -0.25]
  - !!python/tuple
    - !!python/tuple [0, 2]
    - !numpy.ndarray [-0.25, -0.25, -0.25]
  - !!python/tuple
    - !!python/tuple [2, 0]
    - !numpy.ndarray [0.25, 0.25, 0.25]
  - !!python/tuple
    - !!python/tuple [0, 2]
    - !numpy.ndarray [0.25, 0.25, -0.25]
  - !!python/tuple
    - !!python/tuple [2, 0]
    - !numpy.ndarray [-0.25, -0.25, 0.25]
  - !!python/tuple
    - !!python/tuple [0, 1]
    - !numpy.ndarray [0.25, -0.25, -0.25]
  - !!python/tuple
    - !!python/tuple [1, 0]
    - !numpy.ndarray [-0.25, 0.25, 0.25]
  - !!python/tuple
    - !!python/tuple [0, 1]
    - !numpy.ndarray [-0.25, -0.25, 0.25]
  - !!python/tuple
    - !!python/tuple [1, 0]
    - !numpy.ndarray [0.25, 0.25, -0.25]
  - !!python/tuple
    - !!python/tuple [0, 1]
    - !numpy.ndarray [0.25, 0.25, 0.25]
  - !!python/tuple
    - !!python/tuple [1, 0]
    - !numpy.ndarray [-0.25, -0.25, -0.25]
- - !!python/tuple
    - !!python/tuple [2, 1]
    - !numpy.ndarray [0.0, 0.0, 0.5]
  - !!python/tuple
    - !!python/tuple [1, 2]
    - !numpy.ndarray [-0.0, -0.0, -0.5]
  - !!python/tuple
    - !!python/tuple [2, 1]
    - !numpy.ndarray [0.0, -0.5, 0.0]
  - !!python/tuple
    - !!python/tuple [1, 2]
    - !numpy.ndarray [-0.0, 0.5, -0.0]
  - !!python/tuple
    - !!python/tuple [2, 1]
    - !numpy.ndarray [-0.5, 0.0, 0.0]
  - !!python/tuple
    - !!python/tuple [1, 2]
    - !numpy.ndarray [0.5, -0.0, -0.0]
  - !!python/tuple
    - !!python/tuple [2, 1]
    - !numpy.ndarray [0.0, 0.5, 0.0]
  - !!python/tuple
    - !!python/tuple [1, 2]
    - !numpy.ndarray [-0.0, -0.5, -0.0]
  - !!python/tuple
    - !!python/tuple [2, 1]
    - !numpy.ndarray [0.5, 0.0, 0.0]
  - !!python/tuple
    - !!python/tuple [1, 2]
    - !numpy.ndarray [-0.5, -0.0, -0.0]
  - !!python/tuple
    - !!python/tuple [2, 1]
    - !numpy.ndarray [0.0, 0.0, -0.5]
  - !!python/tuple
    - !!python/tuple [1, 2]
    - !numpy.ndarray [-0.0, -0.0, 0.5]

</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Vacancy-mediated-calculator-setup">
<h2>Vacancy-mediated calculator setup<a class="headerlink" href="#Vacancy-mediated-calculator-setup" title="Permalink to this headline">¶</a></h2>
<p>For the vacancy mediated diffuser, the configurations and transition states are more complicated. First, we have three types of configurations:</p>
<ol class="arabic simple">
<li><p>Vacancy, sufficiently far away from the solute to have zero interaction energy.</p></li>
<li><p>Solute, sufficiently far away from the vacancy to have zero interaction energy.</p></li>
<li><p>Vacancy-solute complexes.</p></li>
</ol>
<p>The vacancies and solutes are assumed to be able to occupy the <em>same</em> sites in the crystal, and that neither the vacancy or solute lowers the underlying symmetry of the site. This is a rephrasing of our previous assumption that the symmetry of the defect can be mapped onto the symmetry of the crystal Wyckoff position. There are cases where <em>this is not true</em>: that is, some solutes, when substituted into a crystal, will relax in a way that <em>breaks symmetry</em>. While mathematically this can be
treated, we do not currently have an implementation that supports this.</p>
<p>The complexes are only considered out to a finite distance; this is called the “thermodynamic range.” It is defined in terms of “shells,” which is the number of “jumps” from the solute in order to reach the vacancy. We include one more shell out, called the “kinetic range,” which are complexes that include transitions to complexes in the thermodynamic range.</p>
<p>When we consider transition states, we have three types of transition states:</p>
<ol class="arabic simple">
<li><p>Vacancy transitions, sufficiently far away from the solute to have zero interaction energy.</p></li>
<li><p>Vacancy-solute complex transitions, where only the vacancy changes position (both between complexes in the thermodynamic range, and between the kinetic and thermodynamic range).</p></li>
<li><p>Vacancy-solute complex transitions, where the vacancy and solute exchange place.</p></li>
</ol>
<p>These are called, in the “five-frequency framework”, omega-0, omega-1, and omega-2 jumps, respectively. The five-frequency model technically identifies omega-1 jumps as <em>only</em> between complexes in the thermodynamic range, while the two “additional” jump types, omega-3 and omega-4, connect complexes in the kinetic range to the thermodynamic range. Operationally, we combine omega-1, -3, and -4 into a single set.</p>
<p>To make a diffuser, we need to</p>
<ol class="arabic simple">
<li><p>Identify the <code class="docutils literal notranslate"><span class="pre">sitelist</span></code> of the vacancies (and hence, solutes),</p></li>
<li><p>Identify the <code class="docutils literal notranslate"><span class="pre">jumpnetwork</span></code> of the vacancies</p></li>
<li><p>Determine the thermodynamic range</p></li>
</ol>
<p>then, the diffuser automatically constructs the complexes out to the thermodynamic range, and the full jumpnetworks.</p>
<p>The vacancy-mediated diffuser also identifies unique <strong>tags</strong> for all configurations and transition states. The tags for <em>configurations</em> are strings with</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v:</span></code> followed by unit cell coordinates of site to three decimal digits for the vacancy;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s:</span></code> followed by unit cell coordinates of site to three decimal digits for the solute;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s:...-v:...</span></code> for a solute-vacancy complex.</p></li>
</ul>
<p>The <em>transition states</em> are strings with</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">omega0:</span></code> + (initial vacancy configuration) + <code class="docutils literal notranslate"><span class="pre">^</span></code> + (final vacancy configuration);</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">omega1:</span></code> + (initial solute-vacancy configuration) + <code class="docutils literal notranslate"><span class="pre">^</span></code> + (final vacancy configuration);</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">omega2:</span></code> + (initial solute-vacancy configuration) + <code class="docutils literal notranslate"><span class="pre">^</span></code> + (final solute-vacancy configuration).</p></li>
</ul>
<p>When one pretty-prints the vacancy-mediated diffuser object, the symmetry unique tags are printed. Note that all of the symmetry equivalent tags are stored in the object, and can be used to identify configurations and transition states, and this is the preferred method for indexing, rather than relying on the particular index into the corresponding lists. The vacancy-mediated diffuser calculator contains dictionaries that can be used to convert from tags to indices and vice versa.</p>
<div class="section" id="Face-centered-cubic-crystal,-vacancy-mediated-diffusion">
<h3>Face-centered cubic crystal, vacancy mediated-diffusion<a class="headerlink" href="#Face-centered-cubic-crystal,-vacancy-mediated-diffusion" title="Permalink to this headline">¶</a></h3>
<p>We construct the <code class="docutils literal notranslate"><span class="pre">Onsager</span></code> equivalent of the classic five-frequency model. We can use the sitelist and jumpnetwork that we <em>already constructed for the vacancy by itself</em>. Note that the omega-1 list contains four jumps: one that is the normally identified “omega-1”, and three others that correspond to vacancy “escapes” from the first neighbor complex: to the second, third, and fourth neighbors. In the classic five-frequency model, these rates are all forced to be equal.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">chem</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">fivefreqdiffuser</span> <span class="o">=</span> <span class="n">OnsagerCalc</span><span class="o">.</span><span class="n">VacancyMediated</span><span class="p">(</span><span class="n">FCCcrys</span><span class="p">,</span> <span class="n">chem</span><span class="p">,</span>
                                               <span class="n">FCCsitelist</span><span class="p">,</span> <span class="n">FCCjumpnetwork</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">fivefreqdiffuser</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Diffuser for atom 0 (fcc), Nthermo=1
#Lattice:
  a1 = [ 0.   0.5  0.5]
  a2 = [ 0.5  0.   0.5]
  a3 = [ 0.5  0.5  0. ]
#Basis:
  (fcc) 0.0 = [ 0.  0.  0.]
vacancy configurations:
v:+0.000,+0.000,+0.000
solute configurations:
s:+0.000,+0.000,+0.000
solute-vacancy configurations:
s:+0.000,+0.000,+0.000-v:+1.000,-1.000,+0.000
omega0 jumps:
omega0:v:+0.000,+0.000,+0.000^v:-1.000,+0.000,+0.000
omega1 jumps:
omega1:s:+0.000,+0.000,+0.000-v:+1.000,-1.000,+0.000^v:+0.000,-1.000,+0.000
omega1:s:+0.000,+0.000,+0.000-v:-1.000,+1.000,+0.000^v:-2.000,+1.000,+0.000
omega1:s:+0.000,+0.000,+0.000-v:+0.000,+1.000,-1.000^v:-1.000,+1.000,-1.000
omega1:s:+0.000,+0.000,+0.000-v:-1.000,+0.000,+0.000^v:-2.000,+0.000,+0.000
omega2 jumps:
omega2:s:+0.000,+0.000,+0.000-v:+1.000,+0.000,+0.000^s:+0.000,+0.000,+0.000-v:-1.000,+0.000,+0.000

</pre></div></div>
</div>
<p>An <code class="docutils literal notranslate"><span class="pre">HDF5</span></code> representation of the diffusion calculator can be stored for efficient reconstruction of the object, as well as passing between machines. The <code class="docutils literal notranslate"><span class="pre">HDF5</span></code> representation includes <em>everything</em>: the underlying <code class="docutils literal notranslate"><span class="pre">Crystal</span></code>, the <code class="docutils literal notranslate"><span class="pre">sitelist</span></code> and <code class="docutils literal notranslate"><span class="pre">jumpnetwork</span></code>s, all of the precalculation and analysis needed for diffusion. This greatly speeds up the construction of the calculator.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">h5py</span>
<span class="c1"># replace &#39;/dev/null&#39; with your file of choice, and remove backing_store=False</span>
<span class="c1"># to read and write to an HDF5 file.</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;/dev/null&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s1">&#39;core&#39;</span><span class="p">,</span> <span class="n">backing_store</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">fivefreqdiffuser</span><span class="o">.</span><span class="n">addhdf5</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># adds the diffuser to the HDF5 file</span>

<span class="c1"># how to read in (after opening `f` as an HDF5 file)</span>
<span class="n">fivefreqcopy</span> <span class="o">=</span> <span class="n">OnsagerCalc</span><span class="o">.</span><span class="n">VacancyMediated</span><span class="o">.</span><span class="n">loadhdf5</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># creates a new diffuser from HDF5</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  <span class="c1"># close up the HDF5 file</span>
<span class="k">print</span><span class="p">(</span><span class="n">fivefreqcopy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Diffuser for atom 0 (fcc), Nthermo=1
#Lattice:
  a1 = [ 0.   0.5  0.5]
  a2 = [ 0.5  0.   0.5]
  a3 = [ 0.5  0.5  0. ]
#Basis:
  (fcc) 0.0 = [ 0.  0.  0.]
vacancy configurations:
v:+0.000,+0.000,+0.000
solute configurations:
s:+0.000,+0.000,+0.000
solute-vacancy configurations:
s:+0.000,+0.000,+0.000-v:+1.000,-1.000,+0.000
omega0 jumps:
omega0:v:+0.000,+0.000,+0.000^v:-1.000,+0.000,+0.000
omega1 jumps:
omega1:s:+0.000,+0.000,+0.000-v:+1.000,-1.000,+0.000^v:+0.000,-1.000,+0.000
omega1:s:+0.000,+0.000,+0.000-v:-1.000,+1.000,+0.000^v:-2.000,+1.000,+0.000
omega1:s:+0.000,+0.000,+0.000-v:+0.000,+1.000,-1.000^v:-1.000,+1.000,-1.000
omega1:s:+0.000,+0.000,+0.000-v:-1.000,+0.000,+0.000^v:-2.000,+0.000,+0.000
omega2 jumps:
omega2:s:+0.000,+0.000,+0.000-v:+1.000,+0.000,+0.000^s:+0.000,+0.000,+0.000-v:-1.000,+0.000,+0.000

</pre></div></div>
</div>
</div>
</div>
<div class="section" id="VASP-style-input-files">
<h2>VASP-style input files<a class="headerlink" href="#VASP-style-input-files" title="Permalink to this headline">¶</a></h2>
<p>At this stage, we have the diffusion “calculator” necessary to compute diffusion, but we need to determine appropriate atomic-scale data to act as input into our calculators. There are two primary steps: (1) constructing appropriate “supercells” containing defect configurations and transition states to be computed, and (2) extracting the appropriate information from those calculations to use in the diffuser. This section deals with the former; the next section will deal with the latter.</p>
<p>The tags are the most straightforward way to identify structures as they are computed, and hence they serve as the mechanism for communicating data into the calculators. To make supercells with defects, we take advantage of the <code class="docutils literal notranslate"><span class="pre">supercell</span></code> module in <code class="docutils literal notranslate"><span class="pre">Onsager</span></code>; both calculators contain a <code class="docutils literal notranslate"><span class="pre">makesupercell()</span></code> function that returns dictionaries of supercells, tags, and appropriate information. Currently, to transform these into usable input files, the <code class="docutils literal notranslate"><span class="pre">automator</span></code> module can convert such
dictionaries into tarballs with an appropriate directory structure, files containing information about appropriate tags for the different configurations, a <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> that converts <code class="docutils literal notranslate"><span class="pre">CONTCAR</span></code> output into appropriate <code class="docutils literal notranslate"><span class="pre">POS</span></code> input for the nudged-elastic band calculation.</p>
<p>Both <code class="docutils literal notranslate"><span class="pre">makesupercell()</span></code> commands require an input supercell definition, which is a <span class="math notranslate nohighlight">\(3\times3\)</span> integer matrix of column vectors; if <code class="docutils literal notranslate"><span class="pre">N</span></code> is such a matrix, then the supercell vectors are the columns of <code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">=</span> <span class="pre">np.dot(a,</span> <span class="pre">N)</span></code>, so that <span class="math notranslate nohighlight">\(\mathbf A_1\)</span> has components <code class="docutils literal notranslate"><span class="pre">N[:,0]</span></code> in direct coordinates.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">onsager</span> <span class="kn">import</span> <span class="n">automator</span>
<span class="kn">import</span> <span class="nn">tarfile</span>
</pre></div>
</div>
</div>
<div class="section" id="Face-centered-cubic-crystal,-interstitial-diffusion">
<h3>Face-centered cubic crystal, interstitial diffusion<a class="headerlink" href="#Face-centered-cubic-crystal,-interstitial-diffusion" title="Permalink to this headline">¶</a></h3>
<p>We will need to construct (and relax) appropriate intersitial sites, and the transition states between them.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">help</span><span class="p">(</span><span class="n">FCCintdiffuser</span><span class="o">.</span><span class="n">makesupercells</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on method makesupercells in module onsager.OnsagerCalc:

makesupercells(super_n) method of onsager.OnsagerCalc.Interstitial instance
    Take in a supercell matrix, then generate all of the supercells needed to compute
    site energies and transitions (corresponding to the representatives).

    :param super_n: 3x3 integer matrix to define our supercell
    :return superdict: dictionary of ``states``, ``transitions``, ``transmapping``,
        and ``indices`` that correspond to dictionaries with tags.

        * superdict[&#39;states&#39;][i] = supercell of site;
        * superdict[&#39;transitions&#39;][n] = (supercell initial, supercell final);
        * superdict[&#39;transmapping&#39;][n] = ((site tag, groupop, mapping), (site tag, groupop, mapping))
        * superdict[&#39;indices&#39;][tag] = index of tag, where tag is either a state or transition tag.

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">]])</span>  <span class="c1"># 32 atom FCC supercell</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">FCCcrys</span><span class="o">.</span><span class="n">lattice</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
<span class="n">FCCintsupercells</span> <span class="o">=</span> <span class="n">FCCintdiffuser</span><span class="o">.</span><span class="n">makesupercells</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[ 2.  0.  0.]
 [ 0.  2.  0.]
 [ 0.  0.  2.]]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">help</span><span class="p">(</span><span class="n">automator</span><span class="o">.</span><span class="n">supercelltar</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on function supercelltar in module onsager.automator:

supercelltar(tar, superdict, filemode=436, directmode=509, timestamp=None, INCARrelax=&#39;...&#39;, INCARNEB=&#39;...&#39;, KPOINTS=&#39;...&#39;, basedir=&#39;&#39;, statename=&#39;relax.&#39;, transitionname=&#39;neb.&#39;, IDformat=&#39;{:02d}&#39;, JSONdict=&#39;tags.json&#39;, YAMLdef=&#39;supercell.yaml&#39;)
    Takes in a tarfile (needs to be open for writing) and a supercelldict (from a
    diffuser) and creates the full directory structure inside the tarfile. Best used in
    a form like

    ::

        with tarfile.open(&#39;supercells.tar.gz&#39;, mode=&#39;w:gz&#39;) as tar:
            automator.supercelltar(tar, supercelldict)

    :param tar: tarfile open for writing; may contain other files in advance.
    :param superdict: dictionary of ``states``, ``transitions``, ``transmapping``, ``indices`` that
        correspond to dictionaries with tags; the final tag ``reference`` is the basesupercell
        for calculations without defects.

        * superdict[&#39;states&#39;][i] = supercell of state;
        * superdict[&#39;transitions&#39;][n] = (supercell initial, supercell final);
        * superdict[&#39;transmapping&#39;][n] = ((site tag, groupop, mapping), (site tag, groupop, mapping))
        * superdict[&#39;indices&#39;][tag] = (type, index) of tag, where tag is either a state or transition tag; or...
        * superdict[&#39;indices&#39;][tag] = index of tag, where tag is either a state or transition tag.
        * superdict[&#39;reference&#39;] = (optional) supercell reference, no defects

    :param filemode: mode to use for files (default: 664)
    :param directmode: mode to use for directories (default: 775)
    :param timestamp: UNIX time for files; if None, use current time (default)
    :param INCARrelax: contents of INCAR file to use for relaxation; must contain {system} to be replaced
        by tag value (default: automator.INCARrelax)
    :param INCARNEB: contents of INCAR file to use for NEB; must contain {system} to be replaced
        by tag value (default: automator.INCARNEB)
    :param KPOINTS: contents of KPOINTS file (default: gamma-point only calculation);
        if None or empty, no KPOINTS file at all
    :param basedir: prepended to all files/directories (default: &#39;&#39;)
    :param statename: prepended to all state names, before 2 digit number (default: relax.)
    :param transitionname: prepended to all transition names, before 2 digit number  (default: neb.)
    :param IDformat: format for integer tags (default: {:02d})
    :param JSONdict: name of JSON file storing the tags corresponding to each directory (default: tags.json)
    :param YAMLdef: YAML file containing full definition of supercells, relationship, etc. (default: supercell.yaml);
        set to None to not output. **may want to change this to None for the future**

</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;io-test-int.tar.gz&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w:gz&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tar</span><span class="p">:</span>
    <span class="n">automator</span><span class="o">.</span><span class="n">supercelltar</span><span class="p">(</span><span class="n">tar</span><span class="p">,</span> <span class="n">FCCintsupercells</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tar</span> <span class="o">=</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;io-test-int.tar.gz&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r:gz&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tar</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
?rw-rw-r-- 0/0        244 2017-07-11 16:14:30 INCAR.relax
?rw-rw-r-- 0/0        305 2017-07-11 16:14:30 INCAR.NEB
?rw-rw-r-- 0/0         31 2017-07-11 16:14:30 KPOINTS
?rwxrwxr-x 0/0       1344 2017-07-11 16:14:30 trans.pl
?rwxrwxr-x 0/0       6283 2017-07-11 16:14:30 nebmake.pl
?rw-rw-r-- 0/0      25975 2017-07-11 16:14:30 Vasp.pm
?rwxrwxr-x 0/0          0 2017-07-11 16:14:30 relax.01/
?rw-rw-r-- 0/0       2267 2017-07-11 16:14:30 relax.01/POSCAR
?rw-rw-r-- 0/0        258 2017-07-11 16:14:30 relax.01/INCAR
?rw-rw-r-- 0/0         35 2017-07-11 16:14:30 relax.01/incar.sed
?rw-rw-r-- 0/0          0 2017-07-11 16:14:30 relax.01/KPOINTS -&gt; ../KPOINTS
?rw-rw-r-- 0/0          0 2017-07-11 16:14:30 relax.01/POTCAR -&gt; ../POTCAR
?rwxrwxr-x 0/0          0 2017-07-11 16:14:30 relax.00/
?rw-rw-r-- 0/0       2267 2017-07-11 16:14:30 relax.00/POSCAR
?rw-rw-r-- 0/0        258 2017-07-11 16:14:30 relax.00/INCAR
?rw-rw-r-- 0/0         35 2017-07-11 16:14:30 relax.00/incar.sed
?rw-rw-r-- 0/0          0 2017-07-11 16:14:30 relax.00/KPOINTS -&gt; ../KPOINTS
?rw-rw-r-- 0/0          0 2017-07-11 16:14:30 relax.00/POTCAR -&gt; ../POTCAR
?rwxrwxr-x 0/0          0 2017-07-11 16:14:30 neb.01/
?rw-rw-r-- 0/0       2298 2017-07-11 16:14:30 neb.01/POS.init
?rw-rw-r-- 0/0       2296 2017-07-11 16:14:30 neb.01/POS.final
?rw-rw-r-- 0/0        342 2017-07-11 16:14:30 neb.01/INCAR
?rw-rw-r-- 0/0         58 2017-07-11 16:14:30 neb.01/incar.sed
?rw-rw-r-- 0/0          0 2017-07-11 16:14:30 neb.01/KPOINTS -&gt; ../KPOINTS
?rw-rw-r-- 0/0          0 2017-07-11 16:14:30 neb.01/POTCAR -&gt; ../POTCAR
?rwxrwxr-x 0/0          0 2017-07-11 16:14:30 neb.00/
?rw-rw-r-- 0/0       2298 2017-07-11 16:14:30 neb.00/POS.init
?rw-rw-r-- 0/0       2296 2017-07-11 16:14:30 neb.00/POS.final
?rw-rw-r-- 0/0        342 2017-07-11 16:14:30 neb.00/INCAR
?rw-rw-r-- 0/0         58 2017-07-11 16:14:30 neb.00/incar.sed
?rw-rw-r-- 0/0          0 2017-07-11 16:14:30 neb.00/KPOINTS -&gt; ../KPOINTS
?rw-rw-r-- 0/0          0 2017-07-11 16:14:30 neb.00/POTCAR -&gt; ../POTCAR
?rw-rw-r-- 0/0        191 2017-07-11 16:14:30 neb.00/trans.init
?rw-rw-r-- 0/0        191 2017-07-11 16:14:30 neb.00/trans.final
?rw-rw-r-- 0/0        191 2017-07-11 16:14:30 neb.01/trans.init
?rw-rw-r-- 0/0        191 2017-07-11 16:14:30 neb.01/trans.final
?rw-rw-r-- 0/0       1170 2017-07-11 16:14:30 Makefile
?rw-rw-r-- 0/0         14 2017-07-11 16:14:30 relax.00/NEBlist
?rw-rw-r-- 0/0          7 2017-07-11 16:14:30 relax.01/NEBlist
?rw-rw-r-- 0/0        213 2017-07-11 16:14:30 tags.json
?rw-rw-r-- 0/0    1243794 2017-07-11 16:14:30 supercell.yaml
</pre></div></div>
</div>
<p>Contents of the <code class="docutils literal notranslate"><span class="pre">Makefile</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">tar</span><span class="o">.</span><span class="n">extractfile</span><span class="p">(</span><span class="s1">&#39;Makefile&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
# Makefile to construct NEB input from relaxation output
# we set this so that the makefile doesn&#39;t use builtin implicit rules
MAKEFLAGS = -rk

makeneb := &#34;./nebmake.pl&#34;
transform := &#34;./trans.pl&#34;

Nimages ?= 1

.PHONY: help

target := $(foreach neb, $(wildcard neb.*), $(neb)/01/POSCAR)
target: $(target)

help:
        @echo &#34;# Creates input POSCAR for NEB runs, once relaxation runs are complete&#34;
        @echo &#34;# Uses CONTCAR in relaxation directories to create initial run geometry&#34;
        @echo &#34;# environment variable: Nimages (default: $(Nimages))&#34;
        @echo &#34;# target files:&#34;
        @echo $(target) | sed &#39;s/ / /g&#39;
        @echo &#34;# default target: all&#34;

neb.%: neb.%/01/POSCAR neb.%/POSCAR.init neb.%/POSCAR.final

neb.%/01/POSCAR: neb.%/POSCAR.init neb.%/POSCAR.final
        @$(makeneb) $^ $(Nimages)

neb.%/POSCAR.init:
        @$(transform) $^ &gt; $@

neb.%/POSCAR.final:
        @$(transform) $^ &gt; $@

###############################################################
# structure of NEB runs:
neb.00/POSCAR.init: neb.00/trans.init relax.00/CONTCAR
neb.00/POSCAR.final: neb.00/trans.final relax.00/CONTCAR
neb.01/POSCAR.init: neb.01/trans.init relax.01/CONTCAR
neb.01/POSCAR.final: neb.01/trans.final relax.00/CONTCAR

</pre></div></div>
</div>
<p>Contents of the <code class="docutils literal notranslate"><span class="pre">tags.json</span></code> file:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">tar</span><span class="o">.</span><span class="n">extractfile</span><span class="p">(</span><span class="s1">&#39;tags.json&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{
    &#34;neb.00&#34;: &#34;i:+0.250,+0.250,+0.250^i:+0.750,+0.750,-0.250&#34;,
    &#34;neb.01&#34;: &#34;i:+0.500,+0.500,+0.500^i:+0.250,+1.250,+0.250&#34;,
    &#34;relax.00&#34;: &#34;i:+0.750,+0.750,+0.750&#34;,
    &#34;relax.01&#34;: &#34;i:+0.500,+0.500,+0.500&#34;
}

</pre></div></div>
</div>
<p>Contents of one <code class="docutils literal notranslate"><span class="pre">POSCAR</span></code> file for relaxation of a configuration:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">tar</span><span class="o">.</span><span class="n">extractfile</span><span class="p">(</span><span class="s1">&#39;relax.00/POSCAR&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
i:+0.750,+0.750,+0.750 fcc(32),int_i(1)
1.0
   2.0000000000000000    0.0000000000000000    0.0000000000000000
   0.0000000000000000    2.0000000000000000    0.0000000000000000
   0.0000000000000000    0.0000000000000000    2.0000000000000000
32 1
Direct
  0.0000000000000000  0.0000000000000000  0.0000000000000000
  0.2500000000000000  0.2500000000000000  0.0000000000000000
  0.5000000000000000  0.5000000000000000  0.0000000000000000
  0.7500000000000000  0.7500000000000000  0.0000000000000000
  0.2500000000000000  0.0000000000000000  0.2500000000000000
  0.5000000000000000  0.2500000000000000  0.2500000000000000
  0.7500000000000000  0.5000000000000000  0.2500000000000000
  0.0000000000000000  0.7500000000000000  0.2500000000000000
  0.5000000000000000  0.0000000000000000  0.5000000000000000
  0.7500000000000000  0.2500000000000000  0.5000000000000000
  0.0000000000000000  0.5000000000000000  0.5000000000000000
  0.2500000000000000  0.7500000000000000  0.5000000000000000
  0.7500000000000000  0.0000000000000000  0.7500000000000000
  0.0000000000000000  0.2500000000000000  0.7500000000000000
  0.2500000000000000  0.5000000000000000  0.7500000000000000
  0.5000000000000000  0.7500000000000000  0.7500000000000000
  0.0000000000000000  0.2500000000000000  0.2500000000000000
  0.2500000000000000  0.5000000000000000  0.2500000000000000
  0.5000000000000000  0.7500000000000000  0.2500000000000000
  0.7500000000000000  0.0000000000000000  0.2500000000000000
  0.2500000000000000  0.2500000000000000  0.5000000000000000
  0.5000000000000000  0.5000000000000000  0.5000000000000000
  0.7500000000000000  0.7500000000000000  0.5000000000000000
  0.0000000000000000  0.0000000000000000  0.5000000000000000
  0.5000000000000000  0.2500000000000000  0.7500000000000000
  0.7500000000000000  0.5000000000000000  0.7500000000000000
  0.0000000000000000  0.7500000000000000  0.7500000000000000
  0.2500000000000000  0.0000000000000000  0.7500000000000000
  0.7500000000000000  0.2500000000000000  0.0000000000000000
  0.0000000000000000  0.5000000000000000  0.0000000000000000
  0.2500000000000000  0.7500000000000000  0.0000000000000000
  0.5000000000000000  0.0000000000000000  0.0000000000000000
  0.3750000000000000  0.3750000000000000  0.3750000000000000

</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tar</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Face-centered-cubic-crystal,-vacancy-mediated-diffusion">
<h3>Face-centered cubic crystal, vacancy mediated-diffusion<a class="headerlink" href="#Face-centered-cubic-crystal,-vacancy-mediated-diffusion" title="Permalink to this headline">¶</a></h3>
<p>We will need to construct (and relax) appropriate vacancy, solute, and solute-vacancy complexes, and the transition states between them. The commands are nearly identical to the interstitial diffuser; the primary difference is the larger number of configurations and files.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">help</span><span class="p">(</span><span class="n">fivefreqdiffuser</span><span class="o">.</span><span class="n">makesupercells</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on method makesupercells in module onsager.OnsagerCalc:

makesupercells(super_n) method of onsager.OnsagerCalc.VacancyMediated instance
    Take in a supercell matrix, then generate all of the supercells needed to compute
    site energies and transitions (corresponding to the representatives).

    Note: the states are lone vacancy, lone solute, solute-vacancy complexes in
    our thermodynamic range. Note that there will be escape states are endpoints of
    some omega1 jumps. They are not relaxed, and have no pre-existing tag. They will
    only be output as a single endpoint of an NEB run; there may be symmetry equivalent
    duplicates, as we construct these supercells on an as needed basis.

    We&#39;ve got a few classes of warnings (from most egregious to least) that can issued
    if the supercell is too small; the analysis will continue despite any warnings:

    1. Thermodynamic shell states map to different states in supercell
    2. Thermodynamic shell states are not unique in supercell (multiplicity)
    3. Kinetic shell states map to different states in supercell
    4. Kinetic shell states are not unique in supercell (multiplicity)

    The lowest level can still be run reliably but runs the risk of errors in escape transition
    barriers. Extreme caution should be used if any of the other warnings are raised.

    :param super_n: 3x3 integer matrix to define our supercell
    :return superdict: dictionary of ``states``, ``transitions``, ``transmapping``,
        ``indices`` that correspond to dictionaries with tags; the final tag
        ``reference`` is the basesupercell for calculations without defects.

        * superdict[&#39;states&#39;][i] = supercell of state;
        * superdict[&#39;transitions&#39;][n] = (supercell initial, supercell final);
        * superdict[&#39;transmapping&#39;][n] = ((site tag, groupop, mapping), (site tag, groupop, mapping))
        * superdict[&#39;indices&#39;][tag] = (type, index) of tag, where tag is either a state or transition tag.
        * superdict[&#39;reference&#39;] = supercell reference, no defects

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">]])</span>  <span class="c1"># 108 atom FCC supercell</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">FCCcrys</span><span class="o">.</span><span class="n">lattice</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
<span class="n">fivefreqsupercells</span> <span class="o">=</span> <span class="n">fivefreqdiffuser</span><span class="o">.</span><span class="n">makesupercells</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[ 3.  0.  0.]
 [ 0.  3.  0.]
 [ 0.  0.  3.]]
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;io-test-fivefreq.tar.gz&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w:gz&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tar</span><span class="p">:</span>
    <span class="n">automator</span><span class="o">.</span><span class="n">supercelltar</span><span class="p">(</span><span class="n">tar</span><span class="p">,</span> <span class="n">fivefreqsupercells</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tar</span> <span class="o">=</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;io-test-fivefreq.tar.gz&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r:gz&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tar</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
?rw-rw-r-- 0/0        244 2017-07-11 16:14:53 INCAR.relax
?rw-rw-r-- 0/0        305 2017-07-11 16:14:53 INCAR.NEB
?rw-rw-r-- 0/0         31 2017-07-11 16:14:53 KPOINTS
?rwxrwxr-x 0/0       1344 2017-07-11 16:14:53 trans.pl
?rwxrwxr-x 0/0       6283 2017-07-11 16:14:53 nebmake.pl
?rw-rw-r-- 0/0      25975 2017-07-11 16:14:53 Vasp.pm
?rw-rw-r-- 0/0       6844 2017-07-11 16:14:53 POSCAR
?rwxrwxr-x 0/0          0 2017-07-11 16:14:53 relax.00/
?rw-rw-r-- 0/0       6784 2017-07-11 16:14:53 relax.00/POSCAR
?rw-rw-r-- 0/0        258 2017-07-11 16:14:53 relax.00/INCAR
?rw-rw-r-- 0/0         35 2017-07-11 16:14:53 relax.00/incar.sed
?rw-rw-r-- 0/0          0 2017-07-11 16:14:53 relax.00/KPOINTS -&gt; ../KPOINTS
?rw-rw-r-- 0/0          0 2017-07-11 16:14:53 relax.00/POTCAR -&gt; ../POTCAR
?rwxrwxr-x 0/0          0 2017-07-11 16:14:53 relax.02/
?rw-rw-r-- 0/0       6845 2017-07-11 16:14:53 relax.02/POSCAR
?rw-rw-r-- 0/0        258 2017-07-11 16:14:53 relax.02/INCAR
?rw-rw-r-- 0/0         35 2017-07-11 16:14:53 relax.02/incar.sed
?rw-rw-r-- 0/0          0 2017-07-11 16:14:53 relax.02/KPOINTS -&gt; ../KPOINTS
?rw-rw-r-- 0/0          0 2017-07-11 16:14:53 relax.02/POTCAR -&gt; ../POTCAR
?rwxrwxr-x 0/0          0 2017-07-11 16:14:53 relax.01/
?rw-rw-r-- 0/0       6807 2017-07-11 16:14:53 relax.01/POSCAR
?rw-rw-r-- 0/0        281 2017-07-11 16:14:53 relax.01/INCAR
?rw-rw-r-- 0/0         58 2017-07-11 16:14:53 relax.01/incar.sed
?rw-rw-r-- 0/0          0 2017-07-11 16:14:53 relax.01/KPOINTS -&gt; ../KPOINTS
?rw-rw-r-- 0/0          0 2017-07-11 16:14:53 relax.01/POTCAR -&gt; ../POTCAR
?rwxrwxr-x 0/0          0 2017-07-11 16:14:53 neb.00/
?rw-rw-r-- 0/0       6822 2017-07-11 16:14:53 neb.00/POS.init
?rw-rw-r-- 0/0       6820 2017-07-11 16:14:53 neb.00/POS.final
?rw-rw-r-- 0/0        349 2017-07-11 16:14:53 neb.00/INCAR
?rw-rw-r-- 0/0         65 2017-07-11 16:14:53 neb.00/incar.sed
?rw-rw-r-- 0/0          0 2017-07-11 16:14:53 neb.00/KPOINTS -&gt; ../KPOINTS
?rw-rw-r-- 0/0          0 2017-07-11 16:14:53 neb.00/POTCAR -&gt; ../POTCAR
?rwxrwxr-x 0/0          0 2017-07-11 16:14:53 neb.02/
?rw-rw-r-- 0/0       6845 2017-07-11 16:14:53 neb.02/POS.init
?rw-rw-r-- 0/0       6843 2017-07-11 16:14:53 neb.02/POS.final
?rw-rw-r-- 0/0        372 2017-07-11 16:14:53 neb.02/INCAR
?rw-rw-r-- 0/0         88 2017-07-11 16:14:53 neb.02/incar.sed
?rw-rw-r-- 0/0          0 2017-07-11 16:14:53 neb.02/KPOINTS -&gt; ../KPOINTS
?rw-rw-r-- 0/0          0 2017-07-11 16:14:53 neb.02/POTCAR -&gt; ../POTCAR
?rwxrwxr-x 0/0          0 2017-07-11 16:14:53 neb.04/
?rw-rw-r-- 0/0       6845 2017-07-11 16:14:53 neb.04/POS.init
?rw-rw-r-- 0/0       6843 2017-07-11 16:14:53 neb.04/POSCAR.final
?rw-rw-r-- 0/0        372 2017-07-11 16:14:53 neb.04/INCAR
?rw-rw-r-- 0/0         88 2017-07-11 16:14:53 neb.04/incar.sed
?rw-rw-r-- 0/0          0 2017-07-11 16:14:53 neb.04/KPOINTS -&gt; ../KPOINTS
?rw-rw-r-- 0/0          0 2017-07-11 16:14:53 neb.04/POTCAR -&gt; ../POTCAR
?rwxrwxr-x 0/0          0 2017-07-11 16:14:53 neb.01/
?rw-rw-r-- 0/0       6845 2017-07-11 16:14:53 neb.01/POS.init
?rw-rw-r-- 0/0       6843 2017-07-11 16:14:53 neb.01/POSCAR.final
?rw-rw-r-- 0/0        372 2017-07-11 16:14:53 neb.01/INCAR
?rw-rw-r-- 0/0         88 2017-07-11 16:14:53 neb.01/incar.sed
?rw-rw-r-- 0/0          0 2017-07-11 16:14:53 neb.01/KPOINTS -&gt; ../KPOINTS
?rw-rw-r-- 0/0          0 2017-07-11 16:14:53 neb.01/POTCAR -&gt; ../POTCAR
?rwxrwxr-x 0/0          0 2017-07-11 16:14:53 neb.03/
?rw-rw-r-- 0/0       6845 2017-07-11 16:14:53 neb.03/POS.init
?rw-rw-r-- 0/0       6843 2017-07-11 16:14:53 neb.03/POSCAR.final
?rw-rw-r-- 0/0        372 2017-07-11 16:14:53 neb.03/INCAR
?rw-rw-r-- 0/0         88 2017-07-11 16:14:53 neb.03/incar.sed
?rw-rw-r-- 0/0          0 2017-07-11 16:14:53 neb.03/KPOINTS -&gt; ../KPOINTS
?rw-rw-r-- 0/0          0 2017-07-11 16:14:53 neb.03/POTCAR -&gt; ../POTCAR
?rwxrwxr-x 0/0          0 2017-07-11 16:14:53 neb.05/
?rw-rw-r-- 0/0       6868 2017-07-11 16:14:53 neb.05/POS.init
?rw-rw-r-- 0/0       6866 2017-07-11 16:14:53 neb.05/POS.final
?rw-rw-r-- 0/0        395 2017-07-11 16:14:53 neb.05/INCAR
?rw-rw-r-- 0/0        111 2017-07-11 16:14:53 neb.05/incar.sed
?rw-rw-r-- 0/0          0 2017-07-11 16:14:53 neb.05/KPOINTS -&gt; ../KPOINTS
?rw-rw-r-- 0/0          0 2017-07-11 16:14:53 neb.05/POTCAR -&gt; ../POTCAR
?rw-rw-r-- 0/0        420 2017-07-11 16:14:53 neb.00/trans.init
?rw-rw-r-- 0/0        420 2017-07-11 16:14:53 neb.00/trans.final
?rw-rw-r-- 0/0        420 2017-07-11 16:14:53 neb.01/trans.init
?rw-rw-r-- 0/0        420 2017-07-11 16:14:53 neb.02/trans.init
?rw-rw-r-- 0/0        420 2017-07-11 16:14:53 neb.02/trans.final
?rw-rw-r-- 0/0        420 2017-07-11 16:14:53 neb.03/trans.init
?rw-rw-r-- 0/0        420 2017-07-11 16:14:53 neb.04/trans.init
?rw-rw-r-- 0/0        420 2017-07-11 16:14:53 neb.05/trans.init
?rw-rw-r-- 0/0        420 2017-07-11 16:14:53 neb.05/trans.final
?rw-rw-r-- 0/0       1447 2017-07-11 16:14:53 Makefile
?rw-rw-r-- 0/0          7 2017-07-11 16:14:53 relax.00/NEBlist
?rw-rw-r-- 0/0         35 2017-07-11 16:14:53 relax.01/NEBlist
?rw-rw-r-- 0/0        710 2017-07-11 16:14:53 tags.json
?rw-rw-r-- 0/0    3458541 2017-07-11 16:14:53 supercell.yaml
</pre></div></div>
</div>
<p>Contents of <code class="docutils literal notranslate"><span class="pre">Makefile</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">tar</span><span class="o">.</span><span class="n">extractfile</span><span class="p">(</span><span class="s1">&#39;Makefile&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
# Makefile to construct NEB input from relaxation output
# we set this so that the makefile doesn&#39;t use builtin implicit rules
MAKEFLAGS = -rk

makeneb := &#34;./nebmake.pl&#34;
transform := &#34;./trans.pl&#34;

Nimages ?= 1

.PHONY: help

target := $(foreach neb, $(wildcard neb.*), $(neb)/01/POSCAR)
target: $(target)

help:
        @echo &#34;# Creates input POSCAR for NEB runs, once relaxation runs are complete&#34;
        @echo &#34;# Uses CONTCAR in relaxation directories to create initial run geometry&#34;
        @echo &#34;# environment variable: Nimages (default: $(Nimages))&#34;
        @echo &#34;# target files:&#34;
        @echo $(target) | sed &#39;s/ / /g&#39;
        @echo &#34;# default target: all&#34;

neb.%: neb.%/01/POSCAR neb.%/POSCAR.init neb.%/POSCAR.final

neb.%/01/POSCAR: neb.%/POSCAR.init neb.%/POSCAR.final
        @$(makeneb) $^ $(Nimages)

neb.%/POSCAR.init:
        @$(transform) $^ &gt; $@

neb.%/POSCAR.final:
        @$(transform) $^ &gt; $@

###############################################################
# structure of NEB runs:
neb.00/POSCAR.init: neb.00/trans.init relax.00/CONTCAR
neb.00/POSCAR.final: neb.00/trans.final relax.00/CONTCAR
neb.01/POSCAR.init: neb.01/trans.init relax.01/CONTCAR
neb.02/POSCAR.init: neb.02/trans.init relax.01/CONTCAR
neb.02/POSCAR.final: neb.02/trans.final relax.01/CONTCAR
neb.03/POSCAR.init: neb.03/trans.init relax.01/CONTCAR
neb.04/POSCAR.init: neb.04/trans.init relax.01/CONTCAR
neb.05/POSCAR.init: neb.05/trans.init relax.01/CONTCAR
neb.05/POSCAR.final: neb.05/trans.final relax.01/CONTCAR

</pre></div></div>
</div>
<p>Contents of the <code class="docutils literal notranslate"><span class="pre">tags.json</span></code> file:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">tar</span><span class="o">.</span><span class="n">extractfile</span><span class="p">(</span><span class="s1">&#39;tags.json&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{
    &#34;neb.00&#34;: &#34;omega0:v:+0.000,+0.000,+0.000^v:-1.000,+0.000,+0.000&#34;,
    &#34;neb.01&#34;: &#34;omega1:s:+0.000,+0.000,+0.000-v:+0.000,+1.000,-1.000^v:-1.000,+1.000,-1.000&#34;,
    &#34;neb.02&#34;: &#34;omega1:s:+0.000,+0.000,+0.000-v:+1.000,-1.000,+0.000^v:+0.000,-1.000,+0.000&#34;,
    &#34;neb.03&#34;: &#34;omega1:s:+0.000,+0.000,+0.000-v:-1.000,+0.000,+0.000^v:-2.000,+0.000,+0.000&#34;,
    &#34;neb.04&#34;: &#34;omega1:s:+0.000,+0.000,+0.000-v:-1.000,+1.000,+0.000^v:-2.000,+1.000,+0.000&#34;,
    &#34;neb.05&#34;: &#34;omega2:s:+0.000,+0.000,+0.000-v:+1.000,+0.000,+0.000^s:+0.000,+0.000,+0.000-v:-1.000,+0.000,+0.000&#34;,
    &#34;relax.00&#34;: &#34;v:+0.000,+0.000,+0.000&#34;,
    &#34;relax.01&#34;: &#34;s:+0.000,+0.000,+0.000-v:+1.000,-1.000,+0.000&#34;,
    &#34;relax.02&#34;: &#34;s:+0.000,+0.000,+0.000&#34;
}

</pre></div></div>
</div>
<p>Contents of one <code class="docutils literal notranslate"><span class="pre">POSCAR</span></code> file for relaxation of a configuration:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">tar</span><span class="o">.</span><span class="n">extractfile</span><span class="p">(</span><span class="s1">&#39;relax.01/POSCAR&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
s:+0.000,+0.000,+0.000-v:+1.000,-1.000,+0.000 fcc(106),solute(1)
1.0
   3.0000000000000000    0.0000000000000000    0.0000000000000000
   0.0000000000000000    3.0000000000000000    0.0000000000000000
   0.0000000000000000    0.0000000000000000    3.0000000000000000
106 1
Direct
  0.1666666666666667  0.1666666666666667  0.0000000000000000
  0.3333333333333333  0.3333333333333333  0.0000000000000000
  0.5000000000000000  0.5000000000000000  0.0000000000000000
  0.6666666666666666  0.6666666666666666  0.0000000000000000
  0.8333333333333333  0.8333333333333333  0.0000000000000000
  0.1666666666666667  0.0000000000000000  0.1666666666666667
  0.3333333333333333  0.1666666666666667  0.1666666666666667
  0.5000000000000000  0.3333333333333333  0.1666666666666667
  0.6666666666666666  0.5000000000000000  0.1666666666666667
  0.8333333333333333  0.6666666666666666  0.1666666666666667
  0.0000000000000000  0.8333333333333333  0.1666666666666667
  0.3333333333333333  0.0000000000000000  0.3333333333333333
  0.5000000000000000  0.1666666666666667  0.3333333333333333
  0.6666666666666666  0.3333333333333333  0.3333333333333333
  0.8333333333333333  0.5000000000000000  0.3333333333333333
  0.0000000000000000  0.6666666666666666  0.3333333333333333
  0.1666666666666667  0.8333333333333333  0.3333333333333333
  0.5000000000000000  0.0000000000000000  0.5000000000000000
  0.6666666666666666  0.1666666666666667  0.5000000000000000
  0.8333333333333333  0.3333333333333333  0.5000000000000000
  0.0000000000000000  0.5000000000000000  0.5000000000000000
  0.1666666666666667  0.6666666666666666  0.5000000000000000
  0.3333333333333333  0.8333333333333333  0.5000000000000000
  0.6666666666666666  0.0000000000000000  0.6666666666666666
  0.8333333333333333  0.1666666666666667  0.6666666666666666
  0.0000000000000000  0.3333333333333333  0.6666666666666666
  0.1666666666666667  0.5000000000000000  0.6666666666666666
  0.3333333333333333  0.6666666666666666  0.6666666666666666
  0.5000000000000000  0.8333333333333333  0.6666666666666666
  0.8333333333333333  0.0000000000000000  0.8333333333333333
  0.0000000000000000  0.1666666666666667  0.8333333333333333
  0.1666666666666667  0.3333333333333333  0.8333333333333333
  0.3333333333333333  0.5000000000000000  0.8333333333333333
  0.5000000000000000  0.6666666666666666  0.8333333333333333
  0.6666666666666666  0.8333333333333333  0.8333333333333333
  0.0000000000000000  0.1666666666666667  0.1666666666666667
  0.1666666666666667  0.3333333333333333  0.1666666666666667
  0.3333333333333333  0.5000000000000000  0.1666666666666667
  0.5000000000000000  0.6666666666666666  0.1666666666666667
  0.6666666666666666  0.8333333333333333  0.1666666666666667
  0.8333333333333333  0.0000000000000000  0.1666666666666667
  0.1666666666666667  0.1666666666666667  0.3333333333333333
  0.3333333333333333  0.3333333333333333  0.3333333333333333
  0.5000000000000000  0.5000000000000000  0.3333333333333333
  0.6666666666666666  0.6666666666666666  0.3333333333333333
  0.8333333333333333  0.8333333333333333  0.3333333333333333
  0.0000000000000000  0.0000000000000000  0.3333333333333333
  0.3333333333333333  0.1666666666666667  0.5000000000000000
  0.5000000000000000  0.3333333333333333  0.5000000000000000
  0.6666666666666666  0.5000000000000000  0.5000000000000000
  0.8333333333333333  0.6666666666666666  0.5000000000000000
  0.0000000000000000  0.8333333333333333  0.5000000000000000
  0.1666666666666667  0.0000000000000000  0.5000000000000000
  0.5000000000000000  0.1666666666666667  0.6666666666666666
  0.6666666666666666  0.3333333333333333  0.6666666666666666
  0.8333333333333333  0.5000000000000000  0.6666666666666666
  0.0000000000000000  0.6666666666666666  0.6666666666666666
  0.1666666666666667  0.8333333333333333  0.6666666666666666
  0.3333333333333333  0.0000000000000000  0.6666666666666666
  0.6666666666666666  0.1666666666666667  0.8333333333333333
  0.8333333333333333  0.3333333333333333  0.8333333333333333
  0.0000000000000000  0.5000000000000000  0.8333333333333333
  0.1666666666666667  0.6666666666666666  0.8333333333333333
  0.3333333333333333  0.8333333333333333  0.8333333333333333
  0.5000000000000000  0.0000000000000000  0.8333333333333333
  0.0000000000000000  0.3333333333333333  0.0000000000000000
  0.1666666666666667  0.5000000000000000  0.0000000000000000
  0.3333333333333333  0.6666666666666666  0.0000000000000000
  0.5000000000000000  0.8333333333333333  0.0000000000000000
  0.6666666666666666  0.0000000000000000  0.0000000000000000
  0.0000000000000000  0.3333333333333333  0.3333333333333333
  0.1666666666666667  0.5000000000000000  0.3333333333333333
  0.3333333333333333  0.6666666666666666  0.3333333333333333
  0.5000000000000000  0.8333333333333333  0.3333333333333333
  0.6666666666666666  0.0000000000000000  0.3333333333333333
  0.8333333333333333  0.1666666666666667  0.3333333333333333
  0.1666666666666667  0.3333333333333333  0.5000000000000000
  0.3333333333333333  0.5000000000000000  0.5000000000000000
  0.5000000000000000  0.6666666666666666  0.5000000000000000
  0.6666666666666666  0.8333333333333333  0.5000000000000000
  0.8333333333333333  0.0000000000000000  0.5000000000000000
  0.0000000000000000  0.1666666666666667  0.5000000000000000
  0.3333333333333333  0.3333333333333333  0.6666666666666666
  0.5000000000000000  0.5000000000000000  0.6666666666666666
  0.6666666666666666  0.6666666666666666  0.6666666666666666
  0.8333333333333333  0.8333333333333333  0.6666666666666666
  0.0000000000000000  0.0000000000000000  0.6666666666666666
  0.1666666666666667  0.1666666666666667  0.6666666666666666
  0.5000000000000000  0.3333333333333333  0.8333333333333333
  0.6666666666666666  0.5000000000000000  0.8333333333333333
  0.8333333333333333  0.6666666666666666  0.8333333333333333
  0.0000000000000000  0.8333333333333333  0.8333333333333333
  0.1666666666666667  0.0000000000000000  0.8333333333333333
  0.3333333333333333  0.1666666666666667  0.8333333333333333
  0.6666666666666666  0.3333333333333333  0.0000000000000000
  0.8333333333333333  0.5000000000000000  0.0000000000000000
  0.0000000000000000  0.6666666666666666  0.0000000000000000
  0.1666666666666667  0.8333333333333333  0.0000000000000000
  0.3333333333333333  0.0000000000000000  0.0000000000000000
  0.5000000000000000  0.1666666666666667  0.0000000000000000
  0.8333333333333333  0.3333333333333333  0.1666666666666667
  0.0000000000000000  0.5000000000000000  0.1666666666666667
  0.1666666666666667  0.6666666666666666  0.1666666666666667
  0.3333333333333333  0.8333333333333333  0.1666666666666667
  0.5000000000000000  0.0000000000000000  0.1666666666666667
  0.6666666666666666  0.1666666666666667  0.1666666666666667
  0.0000000000000000  0.0000000000000000  0.0000000000000000

</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tar</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Formatting-of-input-data">
<h2>Formatting of input data<a class="headerlink" href="#Formatting-of-input-data" title="Permalink to this headline">¶</a></h2>
<p>Once the atomic-scale data from an appropriate total energy calculation is finished, the data needs to be input into formats that the appropriate diffusion calculator can understand. There are some common definitions between the two, but some differences as well.</p>
<p>In all cases, we work with the assumption that our states are thermally occupied, and our rates are Arrhenius. That means that the (relative) probability of any state can be written as</p>
<div class="math notranslate nohighlight">
\[\rho = Z^{-1}\rho^0 \exp(-E/k_\text{B}T)\]</div>
<p>for the partition function <span class="math notranslate nohighlight">\(Z\)</span>, a site entropic term <span class="math notranslate nohighlight">\(\rho^0 = \exp(S/k_\text{B})\)</span>, and energy <span class="math notranslate nohighlight">\(E\)</span>. The transition rate from state A to state B is given by</p>
<div class="math notranslate nohighlight">
\[\lambda(\text{A}\to\text{B}) = \frac{\nu^\text{T}_{\text{A}-\text{B}}}{\rho^0_A} \exp(-(E^\text{T}_{\text{A}-\text{B}} - E_\text{A})/k_\text{B}T)\]</div>
<p>where <span class="math notranslate nohighlight">\(E^\text{T}_{\text{A}-\text{B}}\)</span> is the energy of the transition state between A and B, and <span class="math notranslate nohighlight">\(\nu^\text{T}_{\text{A}-\text{B}}\)</span> is the prefactor for the transition state.</p>
<p>If we assume harmonic transition state theory, then we can write the site entropic term <span class="math notranslate nohighlight">\(\rho^0\)</span> as</p>
<div class="math notranslate nohighlight">
\[\rho^0 = \frac{\prod \nu^{\text{perfect-supercell}}}{\prod \nu^{\text{defect-supercell}}}\]</div>
<p>where <span class="math notranslate nohighlight">\(\nu\)</span> are the vibrational eigenvalues of the corresponding supercells, and the prefactor for the transition state is</p>
<div class="math notranslate nohighlight">
\[\nu^\text{T} = \frac{\prod \nu^{\text{perfect-supercell}}}{\prod_{\nu^2&gt;0} \nu^{\text{transition state}}}\]</div>
<p>where we take the product over the real vibrational frequencies in the transition state (there should be one imaginary mode). From a practical point of view, the perfect-supercell cancels out; we will often set <span class="math notranslate nohighlight">\(\rho^0\)</span> to 1 for a single state (so that the other <span class="math notranslate nohighlight">\(\rho^0\)</span> are relative probabilities), and then <span class="math notranslate nohighlight">\(\nu^\text{T}\)</span> becomes more similar to the attempt frequency for the particular jumps. The definitions above map most simply onto a “hopping atom” approximation for the
jump rates: the <span class="math notranslate nohighlight">\(3\times3\)</span> force-constant matrix is computed for the atom that is moving in the transition, and its eigenvalues are used to determine the modes <span class="math notranslate nohighlight">\(\nu\)</span>.</p>
<p>Note the units: <span class="math notranslate nohighlight">\(\rho^0\)</span> is unitless, while <span class="math notranslate nohighlight">\(\nu^\text{T}\)</span> has units of inverse time; this means that the inverse time unit in the computed transport coefficients will come from <span class="math notranslate nohighlight">\(\nu^\text{T}\)</span> values. If they are entered in THz, that contributes <span class="math notranslate nohighlight">\(10^{12}\text{ s}^{-1}\)</span>.</p>
<p>Because we normalize our probabilities, our energies and transition state energies are relative to each other. In all of our calculations, we will multiply energies by <span class="math notranslate nohighlight">\(\beta=(k_\text{B}T)^{-1}\)</span> to get a unitless values as inputs for our diffusion calculators. This means that the diffusers <em>do not have direct information about temperature</em>; explicit temperature factors that appear in the Onsager coefficients must be included by hand from the output transport coefficients. It also means
that the calculators do not have a “unit” of energy; rather, <span class="math notranslate nohighlight">\(k_\text{B}T\)</span> and the energies must be in the same units.</p>
<div class="section" id="Face-centered-cubic-crystal,-interstitial-diffusion">
<h3>Face-centered cubic crystal, interstitial diffusion<a class="headerlink" href="#Face-centered-cubic-crystal,-interstitial-diffusion" title="Permalink to this headline">¶</a></h3>
<p>We need to compute prefactors and energies for our interstitial diffuser. We can <em>also</em> include information about elastic dipoles (derivatives of energy with respect to strain) in order to compute derivatives of diffusivity with respect to strain (elastodiffusion).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">help</span><span class="p">(</span><span class="n">FCCintdiffuser</span><span class="o">.</span><span class="n">diffusivity</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on method diffusivity in module onsager.OnsagerCalc:

diffusivity(pre, betaene, preT, betaeneT, CalcDeriv=False) method of onsager.OnsagerCalc.Interstitial instance
    Computes the diffusivity for our element given prefactors and energies/kB T.
    Also returns the negative derivative of diffusivity with respect to beta (used to compute
    the activation barrier tensor) if CalcDeriv = True
    The input list order corresponds to the sitelist and jumpnetwork

    :param pre: list of prefactors for unique sites
    :param betaene: list of site energies divided by kB T
    :param preT: list of prefactors for transition states
    :param betaeneT: list of transition state energies divided by kB T
    :return D[3,3]: diffusivity as a 3x3 tensor
    :return DE[3,3]: diffusivity times activation barrier (if CalcDeriv == True)

</pre></div></div>
</div>
<p>The ordering in the lists <code class="docutils literal notranslate"><span class="pre">pre</span></code>, <code class="docutils literal notranslate"><span class="pre">beteene</span></code>, <code class="docutils literal notranslate"><span class="pre">preT</span></code> and <code class="docutils literal notranslate"><span class="pre">betaeneT</span></code> corresponds to the <code class="docutils literal notranslate"><span class="pre">sitelist</span></code> and <code class="docutils literal notranslate"><span class="pre">jumpnetwork</span></code> lists. The tags can be used to determine the proper indices. The most straightforward way to store this in python is a dictionary, where the key is the tag, and the value is a list of <code class="docutils literal notranslate"><span class="pre">[prefactor,</span> <span class="pre">energy]</span></code>. The advantage of this is that it can be easily transformed to and from <code class="docutils literal notranslate"><span class="pre">JSON</span></code> for simple serialization.</p>
<p>To see a full list of all tags in the dictionary, the <code class="docutils literal notranslate"><span class="pre">tags</span></code> member of a diffuser gives a dictionary of all tags, ordered to match the structure of <code class="docutils literal notranslate"><span class="pre">sitelist</span></code> and <code class="docutils literal notranslate"><span class="pre">jumpnetwork</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">FCCintdiffuser</span><span class="o">.</span><span class="n">tags</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>{&#39;states&#39;: [[&#39;i:+0.500,+0.500,+0.500&#39;],
  [&#39;i:+0.750,+0.750,+0.750&#39;, &#39;i:+0.250,+0.250,+0.250&#39;]],
 &#39;transitions&#39;: [[&#39;i:+0.500,+0.500,+0.500^i:+0.250,+1.250,+0.250&#39;,
   &#39;i:+0.250,+0.250,+0.250^i:+0.500,-0.500,+0.500&#39;,
   &#39;i:+0.500,+0.500,+0.500^i:+0.750,-0.250,+0.750&#39;,
   &#39;i:+0.750,+0.750,+0.750^i:+0.500,+1.500,+0.500&#39;,
   &#39;i:+0.500,+0.500,+0.500^i:+1.250,+0.250,+0.250&#39;,
   &#39;i:+0.250,+0.250,+0.250^i:-0.500,+0.500,+0.500&#39;,
   &#39;i:+0.500,+0.500,+0.500^i:+0.250,+0.250,+0.250&#39;,
   &#39;i:+0.250,+0.250,+0.250^i:+0.500,+0.500,+0.500&#39;,
   &#39;i:+0.500,+0.500,+0.500^i:+0.250,+0.250,+1.250&#39;,
   &#39;i:+0.250,+0.250,+0.250^i:+0.500,+0.500,-0.500&#39;,
   &#39;i:+0.500,+0.500,+0.500^i:-0.250,+0.750,+0.750&#39;,
   &#39;i:+0.750,+0.750,+0.750^i:+1.500,+0.500,+0.500&#39;,
   &#39;i:+0.500,+0.500,+0.500^i:+0.750,+0.750,-0.250&#39;,
   &#39;i:+0.750,+0.750,+0.750^i:+0.500,+0.500,+1.500&#39;,
   &#39;i:+0.500,+0.500,+0.500^i:+0.750,+0.750,+0.750&#39;,
   &#39;i:+0.750,+0.750,+0.750^i:+0.500,+0.500,+0.500&#39;],
  [&#39;i:+0.250,+0.250,+0.250^i:+0.750,+0.750,-0.250&#39;,
   &#39;i:+0.750,+0.750,+0.750^i:+0.250,+0.250,+1.250&#39;,
   &#39;i:+0.250,+0.250,+0.250^i:-0.250,+0.750,-0.250&#39;,
   &#39;i:+0.750,+0.750,+0.750^i:+1.250,+0.250,+1.250&#39;,
   &#39;i:+0.250,+0.250,+0.250^i:+0.750,-0.250,-0.250&#39;,
   &#39;i:+0.750,+0.750,+0.750^i:+0.250,+1.250,+1.250&#39;,
   &#39;i:+0.250,+0.250,+0.250^i:+0.750,-0.250,+0.750&#39;,
   &#39;i:+0.750,+0.750,+0.750^i:+0.250,+1.250,+0.250&#39;,
   &#39;i:+0.250,+0.250,+0.250^i:-0.250,+0.750,+0.750&#39;,
   &#39;i:+0.750,+0.750,+0.750^i:+1.250,+0.250,+0.250&#39;,
   &#39;i:+0.250,+0.250,+0.250^i:-0.250,-0.250,+0.750&#39;,
   &#39;i:+0.750,+0.750,+0.750^i:+1.250,+1.250,+0.250&#39;]]}
</pre></div>
</div>
</div>
<p>In this example, the energy of the octahedral site is 0, with a base prefactor of 1. The tetrahedral site has an energy of 0.5 (eV) above, with a higher relative vibrational degeneracy of 2. The transition state energy from octahedral to tetrahedral is 1.0 (eV) with a prefactor of 10 (THz); and the transition state energy from tetrahedral to tetrahedral is 2.0 (eV) with a prefactor of 50 (THz).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">FCCintdata</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;i:+0.500,+0.500,+0.500&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
    <span class="s1">&#39;i:+0.750,+0.750,+0.750&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
    <span class="s1">&#39;i:+0.500,+0.500,+0.500^i:+0.750,+0.750,-0.250&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
    <span class="s1">&#39;i:+0.750,+0.750,+0.750^i:+1.250,+1.250,+0.250&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">50.</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Conversion from dictionary to lists for a given kBT</span>
<span class="c1"># We go through the tags in order, and find one in our data set.</span>
<span class="n">kBT</span> <span class="o">=</span> <span class="mf">0.25</span>  <span class="c1"># eV; a rather high temperature</span>
<span class="n">pre</span> <span class="o">=</span> <span class="p">[</span><span class="n">FCCintdata</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">taglist</span> <span class="ow">in</span> <span class="n">FCCintdiffuser</span><span class="o">.</span><span class="n">tags</span><span class="p">[</span><span class="s1">&#39;states&#39;</span><span class="p">]</span>
       <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">taglist</span> <span class="k">if</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">FCCintdata</span><span class="p">]</span>
<span class="n">betaene</span> <span class="o">=</span> <span class="p">[</span><span class="n">FCCintdata</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">kBT</span> <span class="k">for</span> <span class="n">taglist</span> <span class="ow">in</span> <span class="n">FCCintdiffuser</span><span class="o">.</span><span class="n">tags</span><span class="p">[</span><span class="s1">&#39;states&#39;</span><span class="p">]</span>
           <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">taglist</span> <span class="k">if</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">FCCintdata</span><span class="p">]</span>
<span class="n">preT</span> <span class="o">=</span> <span class="p">[</span><span class="n">FCCintdata</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">taglist</span> <span class="ow">in</span> <span class="n">FCCintdiffuser</span><span class="o">.</span><span class="n">tags</span><span class="p">[</span><span class="s1">&#39;transitions&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">taglist</span> <span class="k">if</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">FCCintdata</span><span class="p">]</span>
<span class="n">betaeneT</span> <span class="o">=</span> <span class="p">[</span><span class="n">FCCintdata</span><span class="p">[</span><span class="n">t</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">kBT</span> <span class="k">for</span> <span class="n">taglist</span> <span class="ow">in</span> <span class="n">FCCintdiffuser</span><span class="o">.</span><span class="n">tags</span><span class="p">[</span><span class="s1">&#39;transitions&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">taglist</span> <span class="k">if</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">FCCintdata</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">pre</span><span class="p">,</span><span class="n">betaene</span><span class="p">,</span><span class="n">preT</span><span class="p">,</span><span class="n">betaeneT</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[1.0, 2.0]
[0.0, 2.0]
[10.0, 50.0]
[4.0, 8.0]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">DFCCint</span><span class="p">,</span> <span class="n">dDFCCint</span> <span class="o">=</span> <span class="n">FCCintdiffuser</span><span class="o">.</span><span class="n">diffusivity</span><span class="p">(</span><span class="n">pre</span><span class="p">,</span> <span class="n">betaene</span><span class="p">,</span> <span class="n">preT</span><span class="p">,</span> <span class="n">betaeneT</span><span class="p">,</span> <span class="n">CalcDeriv</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">DFCCint</span><span class="p">,</span> <span class="n">dDFCCint</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[  6.48557013e-02   1.30104261e-18  -1.30104261e-18]
 [  1.30104261e-18   6.48557013e-02   1.30104261e-18]
 [ -1.30104261e-18   1.30104261e-18   6.48557013e-02]]
[[  2.35630632e-01   3.46944695e-18  -3.46944695e-18]
 [  3.46944695e-18   2.35630632e-01   3.46944695e-18]
 [ -3.46944695e-18   3.46944695e-18   2.35630632e-01]]
</pre></div></div>
</div>
<p>The interpretation of this output will be described below.</p>
</div>
<div class="section" id="Face-centered-cubic-crystal,-vacancy-mediated-diffusion">
<h3>Face-centered cubic crystal, vacancy mediated-diffusion<a class="headerlink" href="#Face-centered-cubic-crystal,-vacancy-mediated-diffusion" title="Permalink to this headline">¶</a></h3>
<p>We will need to compute prefactors and energies for our vacancy, solute, and solute-vacancy complexes, and the transition states between them. The difference compared with the interstitial case is that complex prefactors and energies are <em>excess</em> quantities. That means for a complex, its <span class="math notranslate nohighlight">\(\rho^0\)</span> is the product of <span class="math notranslate nohighlight">\(\rho^0\)</span> for the solute state, the vacancy state, <em>and</em> the excess; the energy <span class="math notranslate nohighlight">\(E\)</span> is the sum of the energy of the solute state, the vacancy state, <em>and</em> the excess.
<strong>However</strong> for the <em>transition states</em>, the prefactors and energies are “absolute”.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">help</span><span class="p">(</span><span class="n">fivefreqdiffuser</span><span class="o">.</span><span class="n">Lij</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on method Lij in module onsager.OnsagerCalc:

Lij(bFV, bFS, bFSV, bFT0, bFT1, bFT2, large_om2=100000000.0) method of onsager.OnsagerCalc.VacancyMediated instance
    Calculates the transport coefficients: L0vv, Lss, Lsv, L1vv from the scaled free energies.
    The Green function entries are calculated from the omega0 info. As this is the most
    time-consuming part of the calculation, we cache these values with a dictionary
    and hash function.

    :param bFV[NWyckoff]: beta*eneV - ln(preV) (relative to minimum value)
    :param bFS[NWyckoff]: beta*eneS - ln(preS) (relative to minimum value)
    :param bFSV[Nthermo]: beta*eneSV - ln(preSV) (excess)
    :param bFT0[Nomega0]: beta*eneT0 - ln(preT0) (relative to minimum value of bFV)
    :param bFT1[Nomega1]: beta*eneT1 - ln(preT1) (relative to minimum value of bFV + bFS)
    :param bFT2[Nomega2]: beta*eneT2 - ln(preT2) (relative to minimum value of bFV + bFS)
    :param large_om2: threshold for changing treatment of omega2 contributions (default: 10^8)
    :return Lvv[3, 3]: vacancy-vacancy; needs to be multiplied by cv/kBT
    :return Lss[3, 3]: solute-solute; needs to be multiplied by cv*cs/kBT
    :return Lsv[3, 3]: solute-vacancy; needs to be multiplied by cv*cs/kBT
    :return Lvv1[3, 3]: vacancy-vacancy correction due to solute; needs to be multiplied by cv*cs/kBT

</pre></div></div>
</div>
<p>The vacancy-mediated diffuser expects combined <span class="math notranslate nohighlight">\(\beta F := (E - TS)/k_\text{B}T\)</span>, so that our probabilities and rates are proportional to <span class="math notranslate nohighlight">\(\exp(-\beta F)\)</span>. This is complicated to directly construct, so we have the intermediate function <code class="docutils literal notranslate"><span class="pre">preene2betafree()</span></code>, which is best used by feeding a <em>dictionary</em> of arrays:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">help</span><span class="p">(</span><span class="n">fivefreqdiffuser</span><span class="o">.</span><span class="n">preene2betafree</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on function preene2betafree in module onsager.OnsagerCalc:

preene2betafree(kT, preV, eneV, preS, eneS, preSV, eneSV, preT0, eneT0, preT1, eneT1, preT2, eneT2, **ignoredextraarguments)
    Read in a series of prefactors (exp(S/k_B)) and energies, and return
    beta F for energies and transition state energies. Used to provide scaled values
    to Lij().
    Can specify all of the entries using a dictionary; e.g., ``preene2betafree(kT, **data_dict)``
    and then send that output as input to Lij: ``Lij(*preene2betafree(kT, **data_dict))``
    (we ignore extra arguments so that a dictionary including additional entries can be passed)

    :param kT: temperature times Boltzmann&#39;s constant kB
    :param preV: prefactor for vacancy formation (prod of inverse vibrational frequencies)
    :param eneV: vacancy formation energy
    :param preS: prefactor for solute formation (prod of inverse vibrational frequencies)
    :param eneS: solute formation energy
    :param preSV: excess prefactor for solute-vacancy binding
    :param eneSV: solute-vacancy binding energy
    :param preT0: prefactor for vacancy transition state
    :param eneT0: energy for vacancy transition state (relative to eneV)
    :param preT1: prefactor for vacancy swing transition state
    :param eneT1: energy for vacancy swing transition state (relative to eneV + eneS + eneSV)
    :param preT2: prefactor for vacancy exchange transition state
    :param eneT2: energy for vacancy exchange transition state (relative to eneV + eneS + eneSV)
    :return bFV: beta*eneV - ln(preV) (relative to minimum value)
    :return bFS: beta*eneS - ln(preS) (relative to minimum value)
    :return bFSV: beta*eneSV - ln(preSV) (excess)
    :return bFT0: beta*eneT0 - ln(preT0) (relative to minimum value of bFV)
    :return bFT1: beta*eneT1 - ln(preT1) (relative to minimum value of bFV + bFS)
    :return bFT2: beta*eneT2 - ln(preT2) (relative to minimum value of bFV + bFS)

</pre></div></div>
</div>
<p>Even this is a bit complicated; so we use an additional function that maps the tags into the appropriate lists, <code class="docutils literal notranslate"><span class="pre">tags2preene()</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">help</span><span class="p">(</span><span class="n">fivefreqdiffuser</span><span class="o">.</span><span class="n">tags2preene</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on method tags2preene in module onsager.OnsagerCalc:

tags2preene(usertagdict, VERBOSE=False) method of onsager.OnsagerCalc.VacancyMediated instance
    Generates energies and prefactors based on a dictionary of tags.

    :param usertagdict: dictionary where the keys are tags, and the values are tuples: (pre, ene)
    :param VERBOSE: (optional) if True, also return a dictionary of missing tags, duplicate tags, and bad tags
    :return thermodict: dictionary of ene&#39;s and pre&#39;s corresponding to usertagdict
    :return missingdict: dictionary with keys corresponding to tag types, and the values are
      lists of lists of symmetry equivalent tags that are missing
    :return duplicatelist: list of lists of tags in usertagdict that are (symmetry) duplicates
    :return badtaglist: list of all tags in usertagdict that aren&#39;t found in our dictionary

</pre></div></div>
</div>
<p>In this example, we have a vacancy-solute binding energy of -0.25 (eV), a vacancy jump barrier of 1.0 (eV) with a prefactor of 10 (THz), an “omega-1” activation barrier of 0.75 (eV) which is a transition state energy of 0.75-0.25 = 0.5, an omega-2 activation barrier of 0.5 (eV) which is a transition state energy of 0.5-0.25 = 0.25, and all of the “omega-3/-4” escape jumps with a transition state energy of 1-0.25/2 = 0.875 (eV).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fivefreqdata</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;v:+0.000,+0.000,+0.000&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
    <span class="s1">&#39;s:+0.000,+0.000,+0.000&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
    <span class="s1">&#39;s:+0.000,+0.000,+0.000-v:+0.000,-1.000,+0.000&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">],</span>
    <span class="s1">&#39;omega0:v:+0.000,+0.000,+0.000^v:+0.000,+1.000,+0.000&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
    <span class="s1">&#39;omega1:s:+0.000,+0.000,+0.000-v:+1.000,+0.000,-1.000^v:+1.000,+1.000,-1.000&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
    <span class="s1">&#39;omega1:s:+0.000,+0.000,+0.000-v:+1.000,-1.000,+0.000^v:+1.000,+0.000,+0.000&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">20.</span><span class="p">,</span> <span class="mf">0.875</span><span class="p">],</span>
    <span class="s1">&#39;omega1:s:+0.000,+0.000,+0.000-v:-1.000,+1.000,+0.000^v:-1.000,+2.000,+0.000&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">20.</span><span class="p">,</span> <span class="mf">0.875</span><span class="p">],</span>
    <span class="s1">&#39;omega1:s:+0.000,+0.000,+0.000-v:+0.000,+1.000,+0.000^v:+0.000,+2.000,+0.000&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">20.</span><span class="p">,</span> <span class="mf">0.875</span><span class="p">],</span>
    <span class="s1">&#39;omega2:s:+0.000,+0.000,+0.000-v:+0.000,-1.000,+0.000^s:+0.000,+0.000,+0.000-v:+0.000,+1.000,+0.000&#39;</span><span class="p">:</span>
    <span class="p">[</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Conversion from dictionary to lists for a given kBT</span>
<span class="c1"># note that we can nest the mapping functions.</span>
<span class="n">kBT</span> <span class="o">=</span> <span class="mf">0.25</span>  <span class="c1"># eV; a rather high temperature</span>
<span class="n">fivefreqpreene</span> <span class="o">=</span> <span class="n">fivefreqdiffuser</span><span class="o">.</span><span class="n">tags2preene</span><span class="p">(</span><span class="n">fivefreqdata</span><span class="p">)</span>
<span class="n">fivefreqbetaF</span> <span class="o">=</span> <span class="n">fivefreqdiffuser</span><span class="o">.</span><span class="n">preene2betafree</span><span class="p">(</span><span class="n">kBT</span><span class="p">,</span> <span class="o">**</span><span class="n">fivefreqpreene</span><span class="p">)</span>
<span class="n">L0vv</span><span class="p">,</span> <span class="n">Lss</span><span class="p">,</span> <span class="n">Lsv</span><span class="p">,</span> <span class="n">L1vv</span> <span class="o">=</span> <span class="n">fivefreqdiffuser</span><span class="o">.</span><span class="n">Lij</span><span class="p">(</span><span class="o">*</span><span class="n">fivefreqbetaF</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">L0vv</span><span class="p">,</span> <span class="n">Lss</span><span class="p">,</span> <span class="n">Lsv</span><span class="p">,</span> <span class="n">L1vv</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[ 0.18315639 -0.         -0.        ]
 [-0.          0.18315639 -0.        ]
 [-0.         -0.          0.18315639]]
[[ 1.34561077  0.          0.        ]
 [ 0.          1.34561077  0.        ]
 [ 0.          0.          1.34561077]]
[[-0.40965028  0.          0.        ]
 [ 0.         -0.40965028  0.        ]
 [ 0.          0.         -0.40965028]]
[[ 6.24182702  0.          0.        ]
 [ 0.          6.24182702  0.        ]
 [ 0.          0.          6.24182702]]
</pre></div></div>
</div>
<p>The interpretation of this output will be described below.</p>
</div>
</div>
<div class="section" id="Interpretation-of-output">
<h2>Interpretation of output<a class="headerlink" href="#Interpretation-of-output" title="Permalink to this headline">¶</a></h2>
<p>The final step is to take the output from the diffuser calculator, and convert this into physical quantities: solute diffusivity, elastodiffusivity, Onsager coefficients, drag ratios, and so on.</p>
<p>There are two underlying definitions that we use to define our transport coefficients:</p>
<div class="math notranslate nohighlight">
\[\mathbf j = -\underline D \nabla c\]</div>
<p>defines the <em>solute diffusivity</em> as the tensorial transport coefficient that relates defect concentration gradients to defect fluxes, and</p>
<div class="math notranslate nohighlight">
\[\mathbf j^\text{s} = -\underline L^\text{ss}\nabla\mu^\text{s} - \underline L^\text{sv}\nabla\mu^\text{v}\]</div>
<div class="math notranslate nohighlight">
\[\mathbf j^\text{v} = -\underline L^\text{vv}\nabla\mu^\text{v} - \underline L^\text{sv}\nabla\mu^\text{s}\]</div>
<p>defines the <em>Onsager coefficients</em> as the tensorial transport coefficients that relate solute and vacancy chemical potential gradients to solute and vacancy fluxes. We use these equation to also define the <em>units</em> of our transport coefficients. Fluxes are in units of (number)/area/time, so with concentration in (number)/volume, diffusivity has units of area/time. If the chemical potential is written in units of energy, the Onsager coefficients have units of (number)/length/energy/time. If the
chemical potentials will instead have units of energy/volume, then the corresponding Onsager coefficients have units of area/energy/time.</p>
<p>Below are more specific details about the different calculators and the output available.</p>
<div class="section" id="Interstitial-diffusivity">
<h3>Interstitial diffusivity<a class="headerlink" href="#Interstitial-diffusivity" title="Permalink to this headline">¶</a></h3>
<p>The interstitial diffuser outputs a diffusivity tensor that has the units of squared length based on the lengths in the corresponding <code class="docutils literal notranslate"><span class="pre">Crystal</span></code>, and inverse time units corresponding to the rates that are given as input: the ratio of transition state prefactors to configuration prefactors. In a crystalline system, it is typical to specify the lattice vectors in either nm (<span class="math notranslate nohighlight">\(10^{-9}\text{ m}\)</span>) or Å (<span class="math notranslate nohighlight">\(10^{-10}\text{ m}\)</span>), and the prefactors of rates are often THz
(<span class="math notranslate nohighlight">\(10^{12}\text{ s}\)</span>), while diffusivity is often reported in either <span class="math notranslate nohighlight">\(\text{m}^2/\text{s}\)</span> or <span class="math notranslate nohighlight">\(\text{cm}^2/\text{s}\)</span>. The conversion factors are</p>
<div class="math notranslate nohighlight">
\[1\text{ nm}^2\cdot\text{THz} = 10^{-6}\text{ m}^2/\text{s} = 10^{-2}\text{ cm}^2/\text{s}\]</div>
<div class="math notranslate nohighlight">
\[1\text{ A}^2\cdot\text{THz} = 10^{-8}\text{ m}^2/\text{s} = 10^{-4}\text{ cm}^2/\text{s}\]</div>
<p>It it worth noting that this model of diffusion assumes that the “interstitial” form of the defect is its ground state configuration (or at least <em>one</em> of the configurations used in the derivation of the diffusivity is a ground state configuration). This is generally the case for the diffusion of a vacancy, or light interstitial elements; however, the are materials where a solute has a lower energy as a substitutional defect, but can occupy an interstitial site and diffuse from there. This
requires knowledge of the <em>relative occupancy</em> of the two states. Using Kroger-Vink notation, let [B] be the total solute concentration, and <span class="math notranslate nohighlight">\([\text{B}_\text{A}]\)</span> and <span class="math notranslate nohighlight">\([\text{B}_\text{i}]\)</span> the substitutional and interstitial concentrations, then</p>
<div class="math notranslate nohighlight">
\[D_\text{B} = \left\{[\text{B}_\text{i}]D_\text{int} + [\text{B}_\text{A}]D_\text{sub}\right\}/[\text{B}]\]</div>
<p>for interstitial diffusivity <span class="math notranslate nohighlight">\(D_\text{int}\)</span> and substitutional diffusivity <span class="math notranslate nohighlight">\(D_\text{sub}\)</span>. The relative occupancies may be determined by <em>global thermal equilibrium</em> or <em>local thermal equilibrium</em>. The latter is more complex, and relies on knowledge of local defect processes and conditions, and is not discussed further here. For global thermal equilibrium, if we know the energy of the ground state substitutional defect <span class="math notranslate nohighlight">\(E_\text{sub}\)</span> and the lowest energy configuration used by
the diffuser <span class="math notranslate nohighlight">\(E_\text{int}\)</span>, then</p>
<div class="math notranslate nohighlight">
\[[\text{B}_\text{i}]/[\text{B}] = (1 + \exp((E_\text{int}-E_\text{sub})/k_\text{B}T)^{-1} \approx \exp(-(E_\text{int}-E_\text{sub})/k_\text{B}T)\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[[\text{B}_\text{A}]/[\text{B}] = (1 + \exp(-(E_\text{int}-E_\text{sub})/k_\text{B}T)^{-1} \approx 1\]</div>
<p>where the approximations are valid when <span class="math notranslate nohighlight">\(E_\text{int}-E_\text{sub}\gg k_\text{B}T\)</span>.</p>
</div>
<div class="section" id="Derivatives-of-diffusivity:-activation-barrier-tensor">
<h3>Derivatives of diffusivity: activation barrier tensor<a class="headerlink" href="#Derivatives-of-diffusivity:-activation-barrier-tensor" title="Permalink to this headline">¶</a></h3>
<p>At any given temperature, the temperature dependence of the diffusivity can be taken as an Arrhenius form,</p>
<div class="math notranslate nohighlight">
\[\underline D = \underline D_0 \exp(-\beta \underline E^\text{act})\]</div>
<p>for inverse temperature <span class="math notranslate nohighlight">\(\beta = (k_\text{B}T)^{-1}\)</span>, and the activation barrier, <span class="math notranslate nohighlight">\(\underline E^\text{act}\)</span> can also display anisotropy. Note that in this expression, the exponential is taken on a per-component basis, not as a true tensor exponential. We can compute <span class="math notranslate nohighlight">\(Q\)</span> by taking the per-component logarithmic derivative with respect to inverse temperature,</p>
<div class="math notranslate nohighlight">
\[\underline E^\text{act} = -\underline D^{-1/2}\frac{d\underline D}{d\beta}\underline D^{-1/2}\]</div>
<p>The <code class="docutils literal notranslate"><span class="pre">diffusivity()</span></code> function with <code class="docutils literal notranslate"><span class="pre">CalcDeriv=True</span></code> returns a second tensorial quantity, <code class="docutils literal notranslate"><span class="pre">dD</span></code> which when multiplied by <span class="math notranslate nohighlight">\(k_\text{B}T\)</span>, gives <span class="math notranslate nohighlight">\(d\underline D/d\beta\)</span>. Hence, to compute the activation barrier tensor, we evaluate:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">DFCCint</span><span class="p">),</span> <span class="n">kBT</span><span class="o">*</span><span class="n">dDFCCint</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[  9.08288044e-01  -4.84706356e-18   4.84706356e-18]
 [ -4.84706356e-18   9.08288044e-01  -4.84706356e-18]
 [  4.84706356e-18  -4.84706356e-18   9.08288044e-01]]
</pre></div></div>
</div>
<p>In this case, as the matrices are isotropic, we can use <span class="math notranslate nohighlight">\(\underline D^{-1}\)</span> rather than <span class="math notranslate nohighlight">\(\underline D^{-1/2}\)</span> which must be computed via diagonalization.</p>
<p>This tensor has the same energy units as the variable <code class="docutils literal notranslate"><span class="pre">kBT</span></code>.</p>
<p>Given the barriers for diffusion, one might have expected that <span class="math notranslate nohighlight">\(\underline E^\text{act}\)</span> would be 1, as that is the transition state energy to go from octahedral to tetrahedral. However, the activation barrier is approximately the rate-limiting transition state energy minus the <em>average configuration energy</em>. Since we’ve chosen a large temperature, the tetrahedral sites have non-negligible occupation, which raises the average energy. As the temperature decreases, the activation energy will
approach 1.</p>
</div>
<div class="section" id="Derivatives-of-diffusivity:-elastodiffusion-and-activation-volume-tensor">
<h3>Derivatives of diffusivity: elastodiffusion and activation volume tensor<a class="headerlink" href="#Derivatives-of-diffusivity:-elastodiffusion-and-activation-volume-tensor" title="Permalink to this headline">¶</a></h3>
<p>The derivative with respect to strain is the fourth-rank <em>elastodiffusivity</em> tensor <span class="math notranslate nohighlight">\(\underline d\)</span>, where</p>
<div class="math notranslate nohighlight">
\[d_{abcd} = \frac{dD_{ab}}{d\varepsilon_{cd}}\]</div>
<p>This is returned by the <code class="docutils literal notranslate"><span class="pre">elastodiffusion</span></code> function, which requires the elastic dipole tensors be included in the function call as well. The elastic dipoles have the same units of energies, and so are input as <span class="math notranslate nohighlight">\(\beta\underline P\)</span>, which is unitless. The returned tensor has the same units as the diffusivity.</p>
<p>The <em>activation volume</em> tensor (logarithmic derivative of diffusivity with respect to stress) can be computed from the elastodiffusivity tensor if the compliance tensor <span class="math notranslate nohighlight">\(\underline S\)</span> is known; then,</p>
<div class="math notranslate nohighlight">
\[V^\text{act}_{abcd} = k_\text{B}T \sum_{ijkl=1}^3 (\underline D^{-1/2})_{ai} d_{ijkl} (\underline D^{-1/2})_{bj} S_{klcd}\]</div>
<p>The units of this quantity are given by the units of <span class="math notranslate nohighlight">\(k_\text{B}T\)</span> (energy) multiplied by the units of <span class="math notranslate nohighlight">\(\underline S\)</span> (inverse pressure). Typically, <span class="math notranslate nohighlight">\(k_\text{B}T\)</span> will be known in eV and <span class="math notranslate nohighlight">\(\underline S\)</span> in GPa<span class="math notranslate nohighlight">\(^{-1}\)</span>, so the conversion factor</p>
<div class="math notranslate nohighlight">
\[1\text{ eV}\cdot\text{GPa}^{-1} = 1.6022\times10^{-19}\text{ J}\cdot10^{-9}\text{ m}^3/\text{J} = 0.16022\text{ nm}^3 = 160.22\text{ A}^3\]</div>
<p>can be useful.</p>
</div>
<div class="section" id="Vacancy-mediated-diffusivity">
<h3>Vacancy-mediated diffusivity<a class="headerlink" href="#Vacancy-mediated-diffusivity" title="Permalink to this headline">¶</a></h3>
<p>The interstitial diffuser outputs a diffusivity tensor that has the units of squared length based on the lengths in the corresponding <code class="docutils literal notranslate"><span class="pre">Crystal</span></code>, and inverse time units corresponding to the rates that are given as input: the ratio of transition state prefactors to configuration prefactors. In a crystalline system, it is typical to specify the lattice vectors in either nm (<span class="math notranslate nohighlight">\(10^{-9}\text{ m}\)</span>) or Å (<span class="math notranslate nohighlight">\(10^{-10}\text{ m}\)</span>), and the prefactors of rates are often THz
(<span class="math notranslate nohighlight">\(10^{12}\text{ s}\)</span>). The quantities <code class="docutils literal notranslate"><span class="pre">L0vv</span></code>, <code class="docutils literal notranslate"><span class="pre">Lss</span></code>, <code class="docutils literal notranslate"><span class="pre">Lsv</span></code>, and <code class="docutils literal notranslate"><span class="pre">L1vv</span></code> output by the <code class="docutils literal notranslate"><span class="pre">Lij</span></code> function all have the units of area/time, so the the conversion factors below are often useful:</p>
<div class="math notranslate nohighlight">
\[1\text{ nm}^2\cdot\text{THz} = 10^{-6}\text{ m}^2/\text{s} = 10^{-2}\text{ cm}^2/\text{s}\]</div>
<div class="math notranslate nohighlight">
\[1\text{ A}^2\cdot\text{THz} = 10^{-8}\text{ m}^2/\text{s} = 10^{-4}\text{ cm}^2/\text{s}\]</div>
<p>To convert the four quantities into <span class="math notranslate nohighlight">\(\underline L^\text{vv}\)</span>, <span class="math notranslate nohighlight">\(\underline L^\text{ss}\)</span>, and <span class="math notranslate nohighlight">\(\underline L^\text{sv}\)</span>, some additional information is required.</p>
<p>First, in the dilute limit, <span class="math notranslate nohighlight">\(\underline L^\text{ss}\)</span> and <span class="math notranslate nohighlight">\(\underline L^\text{sv}\)</span> are proportional to <span class="math notranslate nohighlight">\((k_\text{B}T)^{-1}c^\text{v}c^\text{s}\)</span>; none of these quantities are known to the diffuser, and the two concentrations are essentially independent variables that must be supplied. The concentrations in these cases are <em>fractional concentrations</em>, not per volume. Finally, if the Onsager coefficients are for chemical potential specified as energies (not energies per volume),
the quantities need to be <em>divided by the volume per atom</em>, and the final quantity has the appropriate units. Hence,</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\underline L^\text{ss}\)</span> = <code class="docutils literal notranslate"><span class="pre">Lss*(solute</span> <span class="pre">concentration)*(vacancy</span> <span class="pre">concentration)/(volume)/kBT</span></code></p></li>
<li><p><span class="math notranslate nohighlight">\(\underline L^\text{sv}\)</span> = <code class="docutils literal notranslate"><span class="pre">Lsv*(solute</span> <span class="pre">concentration)*(vacancy</span> <span class="pre">concentration)/(volume)/kBT</span></code></p></li>
</ul>
<p>where the concentration quantities are <em>fractional</em>.</p>
<p>The vacancy <span class="math notranslate nohighlight">\(\underline L^\text{vv}\)</span> is more complicated, as it has a leading order term that is independent of solute, and a first order correction that is linear in the solute concentration. Hence,</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\underline L^\text{vv}\)</span> = <code class="docutils literal notranslate"><span class="pre">(L0vv</span> <span class="pre">+</span> <span class="pre">L1vv*(solute</span> <span class="pre">concentration))*(vacancy</span> <span class="pre">concentration)/(volume)/kBT</span></code></p></li>
</ul>
</div>
<div class="section" id="Drag-ratio">
<h3>Drag ratio<a class="headerlink" href="#Drag-ratio" title="Permalink to this headline">¶</a></h3>
<p>The <em>drag ratio</em> is the unitless (tensorial) quantity <span class="math notranslate nohighlight">\(\underline L^\text{sv}(\underline L^\text{ss})^{-1}\)</span>. Because of the identical prefactors in front of both terms in the dilute limit, this is given by</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Lsv</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">Lss</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[-0.30443445  0.          0.        ]
 [ 0.         -0.30443445  0.        ]
 [ 0.          0.         -0.30443445]]
</pre></div></div>
</div>
<p>The vacancy wind factor <span class="math notranslate nohighlight">\(G=\underline L^\text{As}(\underline L^\text{ss})^{-1}\)</span> is related to the drag ratio by simple transformations.</p>
</div>
<div class="section" id="Solute-diffusivity-in-the-dilute-limit">
<h3>Solute diffusivity in the dilute limit<a class="headerlink" href="#Solute-diffusivity-in-the-dilute-limit" title="Permalink to this headline">¶</a></h3>
<p>The solute diffusivity can also be computed for the dilute limit as well. The general relation between <span class="math notranslate nohighlight">\(\underline D^\text{s}\)</span> and the Onsager transport coefficients is</p>
<div class="math notranslate nohighlight">
\[\underline D^\text{s} = k_\text{B}T\Omega\left\{(c^\text{s})^{-1}\underline L^\text{ss} - (1-c^\text{s}-c^\text{v})^{-1}\underline L^\text{As}\right\}\left(1+\frac{d\ln\gamma^\text{s}}{d\ln c^\text{s}}\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(\Omega\)</span> is the volume per atom and <span class="math notranslate nohighlight">\(\gamma^\text{s}\)</span> is the solute activity:</p>
<div class="math notranslate nohighlight">
\[\mu^\text{s} = \mu^\text{s}_0 + k_\text{B}T\ln\left(\gamma^\text{s}c^\text{s}/c^\text{s}_0\right)\]</div>
<p>In the dilute limit, <span class="math notranslate nohighlight">\(\gamma^\text{s}\to 1\)</span>, and thus</p>
<div class="math notranslate nohighlight">
\[\underline D^\text{s} = k_\text{B}T\Omega(c^\text{s})^{-1}\underline L^\text{ss}\]</div>
<p>Conveniently, this cancels most of the “missing” prefactors we put in to compute the Onsager coefficient; hence,</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\underline D^\text{s}\)</span> = <code class="docutils literal notranslate"><span class="pre">Lss*(vacancy</span> <span class="pre">concentration)</span></code></p></li>
</ul>
<p>where the concentration quantities are <em>fractional</em>. In the case of <em>global thermal equilibrium</em>, the vacancy concentration is the equilibrium concentration <span class="math notranslate nohighlight">\(\exp(-(E^\text{v}_\text{form} - TS^\text{v}_\text{form})/k_\text{B}T)\)</span>.</p>
<p>A similar argument holds for the vacancy diffusivity in the dilute limit</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\underline D^\text{v}\)</span> = <code class="docutils literal notranslate"><span class="pre">L0vv</span> <span class="pre">+</span> <span class="pre">(solute</span> <span class="pre">concentration)*L1vv</span></code></p></li>
</ul>
<p>The off-diagonal diffusivity terms are more complex as (1) they are non-symmetric (<span class="math notranslate nohighlight">\(\underline D^\text{sv} \ne \underline D^\text{vs}\)</span>), and (2) the vacancy-dependency of the solute activity and the solute-dependence of the vacancy activity needs to be known to properly include thermodynamic factors.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="notebooks.html" class="btn btn-neutral float-right" title="Example Notebooks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="includeme.html" class="btn btn-neutral float-left" title="Onsager" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Dallas R. Trinkle

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>